<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Regional Module Graphical User Interface (GUI) User Guide</title>
<!-- 2015-08-04 Tue 11:32 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Mohamad Elmasri" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="css/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="css/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="css/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Regional Module Graphical User Interface (GUI) User Guide</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. General information</a></li>
<li><a href="#sec-2">2. Importing questionnaire to the database</a></li>
<li><a href="#sec-3">3. Exporting data to Excel</a>
<ul>
<li><a href="#sec-3-1">3.1. Choosing a country name, year and series</a></li>
<li><a href="#sec-3-2">3.2. Moving data between series</a></li>
<li><a href="#sec-3-3">3.3. Exporting options</a></li>
</ul>
</li>
<li><a href="#sec-4">4. Status fame and Log subfolder</a></li>
<li><a href="#sec-5">5. Processing report</a></li>
<li><a href="#sec-6">6. A complete example</a>
<ul>
<li><a href="#sec-6-1">6.1. Importing the original questionnaire</a></li>
<li><a href="#sec-6-2">6.2. Moving to and exporting from the /Observed/(Clean) series.</a></li>
<li><a href="#sec-6-3">6.3. Cleaning and re-importing</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="fig:RM_GUI" class="figure">
<p><img src="./img/RM_GUI.png" alt="RM_GUI.png" />
</p>
<p><span class="figure-number">Figure 1:</span> A Screen shot of RM_GUI</p>
</div>

<p>
This document explains how to use the software GUI of the Regional module. There are four main frames in the GUI that could be seen in Figure <a href="#fig:RM_GUI">1</a>.
</p>
<ul class="org-ul">
<li><b>General information</b>: General session and user information as the user name and database location.
</li>
<li><b>Importing questionnaire to the database: test</b>: tools needed to a single or a folder of questionnaires.
</li>
<li><b>Exporting data to Excel</b>: tools to export and visualize the data in the database.
</li>
<li><b>Status</b>: a panel that outputs updates on the carried procedures, including any errors.
</li>
</ul>

<div class="sidebar">
<p>
In this guide you will learn to:
</p>
<ul class="org-ul">
<li>Import questionnaires.
</li>
<li>Export and and view data.
</li>
<li>Move data between series.
</li>
<li>And hopefully some Python.
</li>
</ul>

</div>
<p>
Each frame has a specific subsection below that explains in details how to use the available tools.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> General information</h2>
<div class="outline-text-2" id="text-1">
<p>
This frame constitute of information that are essential for all the tool in other frames and will be used all over this guide.
</p>

<ul class="org-ul">
<li><b>Username</b>
        The user name is automatically retrieved from the windows login information. 
</li>
<li><b>Main working directory</b>
      The location of the main folder where all the other mentioned subfolderes are located.
</li>
<li><b>Database</b>
Variable <code>Database</code> shows the location of the database(<code>.db</code> file), in Figure <a href="#fig:RM_GUI">1</a> the is located 
in the main folder in subfolder <code>Database</code> in file <code>UISProd.db</code> as indicated by <code>/Database/UISProd.db</code>. 
For example if the main folder is <code>/Desktop/RMS</code> then the database file is at <code>/Desktop/RMS/Database/UISProd</code>.   
</li>
<li><b>Log folder</b>
        Every time a user attempts to write, read or move data, a log file is created in the subfolder <code>Log</code> in the main folder. See Section <a href="#sec-5">5</a> for more details.
</li>
<li><b>Output folder</b>
       A default folder where exported Excel workbooks are save if no other folder is specified.
</li>
<li><b>Import backup folder</b>
       Every time a data is successfully imported through this <a href="#fig:RM_GUI">GUI</a> a copy of the data along with time and date stamps are saved to this folder.
</li>
</ul>

<div class="note">
<ul class="org-ul">
<li>Data in the general information frame are only editable from the scripts, not from the GUI.
</li>
<li>Only the Export folder is editable through the export panel.
</li>
</ul>

</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Importing questionnaire to the database</h2>
<div class="outline-text-2" id="text-2">
<p>
Two ways exist to importing questionnaires. 
</p>
<ol class="org-ol">
<li>Importing a single questionnaire
In this method click on <code>Browse..</code> button that is adjacent to <code>file</code> label, select a file and then click the adjacent <code>import</code> button.
</li>
<li>Importing a folder of questionnaires.
Here click on <code>Browse..</code> that is adjacent to <code>folder</code> label, select a folder and then click on the adjacent <code>import</code> button.
</li>
</ol>

<p>
Inf= both cases, each file is first validated with pre-precessing checks to make sure that it conforms with the coding scheme. Validation logs will appear in the <i>Status</i> frame and also a report is written in the <code>Log folder</code>. 
</p>

<p>
For more detailed information about the pre-processing report please refer to <a href="#sec-5">5</a>
</p>

<div class="note">
<ul class="org-ul">
<li>Note that only files with <code>.xlsx</code> extensions are imported in both cases.
</li>
<li>All imported files are copied to the <code>Export</code> subfolder with time and data stamps concatenated to their names to indicate the time of importing.
</li>
</ul>

</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Exporting data to Excel</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> Choosing a country name, year and series</h3>
<div class="outline-text-3" id="text-3-1">
<p>
The <code>Country</code> drop-down list will only show the country names of with data already imported to  the database. This drop-down is directly connected to the database, and if one imports a questionnaire for a new country as shown in a <a href="#sec-2">previous section</a>, the new country name should appear in the drop-down list.
</p>

<p>
One a Country name is selected, the data year of all available data should be available in the <code>Year</code> drop-down list. Generally the <code>Year</code> drop-down list will show two consecutive years, since the questionnaire requests some data for a precedent year.
</p>

<p>
The series drop-down list has three options
</p>
<ol class="org-ol">
<li>Reported (REP): where the original questionnaire is inserted. Given that no programme team has changed modified any of the data in this series, it should be the same as the original questionnaire.
</li>
<li>Clean (CLN): where the programme teams modify and validate the data.
</li>
<li>Estimated (EST): where the disseminated data set should be.
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Moving data between series</h3>
<div class="outline-text-3" id="text-3-2">
<p>
An orgininal questionnaire is always imported to the Reported series, to move it the Clean or Estimated series, choose first the country and year, and then click on the button in the <code>Move between databses</code> frame.
</p>

<p>
<code>REP to CLN</code> would move the data of the selected country and year from Reported series to Clean series.
</p>

<p>
<code>CLN to EST</code> would move the data of the selected country and year from the Clean series to Estimated series.
</p>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> Exporting options</h3>
<div class="outline-text-3" id="text-3-3">
<div class="important">
<p>
This section is important because is contains many necessary details to understand how the whole GUI works.
</p>

</div>

<p>
There are three ways to export the data, sheet only, table only and alphanumeric code only. 
</p>
<ol class="org-ol">
<li>Sheet: a drop-down list of all exportable questionnaire sheet names. Once a sheet is selected click on the adjacent <code>Export</code> button to export it to a new Excel workbook. To export all available sheets select <code>All</code> from the drop-down list.
</li>
<li>Table: a drop-down list with all tables of the questionnaire. By selecting one and clicking on the adjacent <code>Export</code> button an new Excel workbook is created that hold the selected table.
</li>
<li>AC: a drop-down list with all alphanumeric codes (AC) that are in the questionnaire. By selecting one and clicking on the adjacent <code>Export</code> button a new Excel workbook is created that holds the data.
</li>
</ol>

<div class="note">
<p>
The exported workbooks are by default saved to <code>Export</code> subfolder with
the naming convention <code>County Name-Year-Exported Variable-Series.xlsx</code>. Users
can change where to save exported files by selecting a folder in the option
<code>Select output folder</code> as seen in the <code>Exporting data to Excel</code> frame
in Figure <a href="#fig:RM_GUI">1</a>. 
</p>

</div>

<p>
Also there are two viewing modes, and <code>Edit</code> and a <code>Read only</code> mode. 
</p>
<ol class="org-ol">
<li><code>Edit</code> mode: allows users to edit the data, comments and inclusion in the excel sheet and re-import them to the database as shown in <a href="#sec-2">Importing questionnaire to the database</a> section. This work by preserving the table location exactly where they are it the original questionnaire. Users will notice that the exported Excel using edit mode looks very similar to the original questionnaire. <b>DO NOT</b> move tables from their original location,  change the sheet name, or delete any of the data in the configuration panel in the top left corner as seen in Figure <a href="#fig:exportConfig">2</a>. You are only allowed to modify cell figures, comments and inclusions.
</li>
<li><code>Read only</code> mode: facilitates the viewing of the data by shifting tables to the left part of the Excel worksheet to avoid any necessary scrolling. However, the mode will not allow users to re-import the data back in the database, since the tables or alphanumeric codes are not in the exact location as they are in the original questionnaire.
</li>
</ol>


<div id="fig:exportConfig" class="figure">
<p><img src="./img/exportConfig.png" alt="exportConfig.png" />
</p>
<p><span class="figure-number">Figure 2:</span> A Screen of the top left corner of an exported Excel sheet.</p>
</div>

<div class="note">
<p>
The viewing mode is chosen by the software. It is set to <code>Edit</code> mode if a sheet or the whole questionnaire is exported, otherwise it is set to <code>Read only</code> mode. Users can know the mode by looking at the top left corner of any exported Excel sheet as seen in Figure <a href="#fig:exportConfig">2</a>.
</p>

</div>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Status fame and Log subfolder</h2>
<div class="outline-text-2" id="text-4">
<p>
The <code>Status</code> frame is a read-only text box that outputs all progression signals and errors. Some of the outputs are also recorded in the <code>Log</code> subfolder. 
</p>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Processing report</h2>
<div class="outline-text-2" id="text-5">
<p>
A pre-processing report is created every time one attempts to import a questionnaire. It includes all confirmations and errors and have the following naming convention <code>Country Name-Year-Series-Data-Type-Time-Date.txt</code>. Some the data included in the report is also printed in the <code>Status</code> frame.
</p>

<p>
The idea of the processing report is to list errors and data problems exist before inserting the questionnaire. Only if all the data checks pass the questionnaire is imported.
</p>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> A complete example</h2>
<div class="outline-text-2" id="text-6">
</div><div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1"><span class="section-number-3">6.1</span> Importing the original questionnaire</h3>
<div class="outline-text-3" id="text-6-1">
<p>
To give an example consider importing <code>LAOS</code> data for year <code>2012</code> that is saved in a file called <code>LAOS-2012-RM.xlsx</code>. That is saved in the folder <code>Desktop/Example</code> as seen in Figure <a href="#fig:laosDesktop">3</a>. Let's first start the <code>RM_GUI.py</code> select the file and click import, which shows the following text in the <code>Status</code> label.
</p>


<div id="fig:laosDesktop" class="figure">
<p><img src="./img/LAOS_desktop.png" alt="LAOS_desktop.png" />
</p>
<p><span class="figure-number">Figure 3:</span> LAOS Original questionnaire submission.</p>
</div>

<pre class="example">
Importing C:/Users/Mohamad/Desktop/Example/LAOS-2012-RM.xlsx
Date: 08/03/15
Questionnaire path: C:/Users/Mohamad/Desktop/Example/LAOS-2012-RM.xlsx
All the checks passes. QUESTIONNAIRE CAN BE PROCESSED
Import successful...Done
</pre>

<p>
This implies the import is successfully.
</p>
</div>
</div>

<div id="outline-container-sec-6-2" class="outline-3">
<h3 id="sec-6-2"><span class="section-number-3">6.2</span> Moving to and exporting from the /Observed/(Clean) series.</h3>
<div class="outline-text-3" id="text-6-2">
<p>
After a successful original import, one can move the data from <i>Reported</i> to <i>Observed</i> series. First notice that the <code>Country</code> drop-down list included Laos to confirm it exists in the database. Select <code>Laos</code> and the corresponding year, then click on <code>REP to OBS</code> button. The <code>Status</code> frame looks like <a href="#fig:laosREP2CLN">this</a> now.
</p>


<div id="fig:laosREP2CLN" class="figure">
<p><img src="./img/LASO_moveCLN.png" alt="LASO_moveCLN.png" />
</p>
<p><span class="figure-number">Figure 4:</span> LAOS data moved from REP to CLN.</p>
</div>

<p>
Now, let's export <code>Teachers ISCED 2</code> for cleaning. Select the country, year and series from the drop-down lists and from the <code>Sheet</code> drop-down list select <code>Teachers ISCED 2</code> and before clicking on the adjacent <code>Export</code> button, select the <code>output folder</code> to be your <code>Desktop</code>.  The <code>Status</code> frame will have the confirmation seen in box <a href="#src:export_clean">1</a>, and the Excel workbook should look like <i>this</i>. Notice the configurations in the top left corner, where the mode is <code>Edit</code> and the series is <code>OBS</code>. 
</p>

<pre class="example" id="src:export_clean">
Exporting Teachers ISCED 2 from OBS series for Lao People's Democratic Republic-2012....
File C:/Users/Mohamad/Desktop/Example/Lao People's Democratic Republic_2012_Teachers ISCED 2_OBS.xlsx is created..
Done.
</pre>


<div id="fig:export_clean" class="figure">
<p><img src="./img/export_clean.png" alt="export_clean.png" />
</p>
<p><span class="figure-number">Figure 5:</span> Exported LAOS data from observed series.</p>
</div>
</div>
</div>

<div id="outline-container-sec-6-3" class="outline-3">
<h3 id="sec-6-3"><span class="section-number-3">6.3</span> Cleaning and re-importing</h3>
<div class="outline-text-3" id="text-6-3">
<p>
As mentioned before as long as the configuration panel is left
untouched and all tables are not moved, one can go ahead and change
the data, inclusion codes and insert cell and table comments. For
example, assume that Laos-2012 data reported under <code>T.2.GPV.Pu.F</code> in
col 3 is not trusted an we rather trust <code>T.2.GPV.Pu</code> in column 2 and
include <code>T.2.GPV.Pu.F</code> under it. Also we add a comment that the data
is not trusted. See Figure <a href="#fig:laos_mod">6</a> and compare it to Figure
<a href="#fig:export_clean">5</a>.
</p>

<div id="fig:laos_mod" class="figure">
<p><img src="./img/laos_mod.png" alt="laos_mod.png" />
</p>
<p><span class="figure-number">Figure 6:</span> Modified LAOS data from observed series.</p>
</div>


<p>
<b>To import</b> follow similar step as in Section <a href="#sec-2">2</a>. Start <code>RM_GUI</code> select the modified file and import
 it. If successful the <code>Status</code> frame should show
</p>
<pre class="example">
Importing C:/Users/Mohamad/Desktop/Example/Lao People's Democratic Republic_2012_Teachers ISCED 2_OBS.xlsx
Import successful...Done
</pre>
<p>
otherwise it would list validation errors such as.
</p>
<pre class="example">
Pre-processing validation failed. Some erros exist see log file in:
Log
Importing C:/Users/Mohamad/Desktop/Example/Lao People's Democratic Republic_2012_Teachers ISCED 2_OBS.xlsx
Column 14 in table Table 2.2 has improper values.
</pre>

<p>
Now if you re-export the whole questionnaire, <code>Teachers ISCED 2</code>
sheet, or only <code>Table 2.1</code> from the observed series, you should be
able to see the changes and comments.
</p>

<p>
Example, done.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Mohamad Elmasri</p>
<p class="date">Created: 2015-08-04 Tue 11:32</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.4.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
