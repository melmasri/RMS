<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Regional Module Graphical User Interface (GUI) User Guide</title>
<!-- 2015-08-12 Wed 15:23 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Mohamad Elmasri" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="css/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="css/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="css/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Regional Module Graphical User Interface (GUI) User Guide</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. General information</a></li>
<li><a href="#sec-2">2. Importing questionnaire to the database</a></li>
<li><a href="#sec-3">3. Exporting data to Excel</a>
<ul>
<li><a href="#sec-3-1">3.1. Choosing a country name, year and series</a></li>
<li><a href="#sec-3-2">3.2. Moving data between series</a></li>
<li><a href="#sec-3-3">3.3. Exporting options</a></li>
</ul>
</li>
<li><a href="#sec-4">4. Status frame and Log subfolder</a></li>
<li><a href="#sec-5">5. Processing report</a></li>
<li><a href="#sec-6">6. A complete example</a>
<ul>
<li><a href="#sec-6-1">6.1. Importing the original questionnaire</a></li>
<li><a href="#sec-6-2">6.2. Moving to and exporting from the Observed series.</a></li>
<li><a href="#sec-6-3">6.3. Cleaning and re-importing</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="fig:RM_GUI" class="figure">
<p><img src="./img/RM_GUI.png" alt="RM_GUI.png" />
</p>
<p><span class="figure-number">Figure 1:</span> Screen shot of RM_GUI.</p>
</div>

<p>
This document explains how to use the management system GUI of the Regional Module. There are four main frames in the GUI that could be seen in Figure <a href="#fig:RM_GUI">1</a>.
</p>
<ul class="org-ul">
<li><a href="#sec-1">General information</a>: general session and user information as
the user-name and database location, log, &#x2026;
</li>
<li><a href="#sec-2">Importing questionnaire to the database</a>: tools to
import a single questionnaire of a folder of questionnaires.
</li>
<li><a href="#sec-3">Exporting data to Excel</a>: tools to export and visualize the
data that are already in the database.
</li>
<li><a href="#sec-4">Status</a>: a panel that outputs updates on the carried procedures, including any errors.
</li>
</ul>

<div class="sidebar">
<p>
In this guide you will learn to:
</p>
<ul class="org-ul">
<li>Import questionnaires.
</li>
<li>Export and and view data for cleaning.
</li>
<li>Move data between series.
</li>
<li>And hopefully some Python.
</li>
</ul>

</div>
<p>
Each frame has a specific subsection below that explains in details how to use the available tools.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> General information</h2>
<div class="outline-text-2" id="text-1">
<p>
This frame holds information that are essential for all tools in other frames, and will be used all over this guide.
</p>

<ul class="org-ul">
<li><b>User</b> prints the automatically retrieved user name from the windows login information. 
</li>
<li><b>Main working directory</b> is the path of the main folder where all the other mentioned subfolders are located.
</li>
<li><b>Database</b> shows the path to the physical database(<code>.db</code>
file). In Figure <a href="#fig:RM_GUI">1</a> it is in the subfolder <code>Database</code> of
main folder as indicated by <code>/Database/Prod.db</code>. For example if the main directory is <code>/Desktop/RMS</code> then the database file is at <code>/Desktop/RMS/Database/UISProd</code>.   
</li>
<li><b>Log folder</b> holds error and processing logs every time a user
attempts to write, read or move data. It is also a subfolder of
the main directory. See Section <a href="#sec-5">5</a> for more details.
</li>
<li><b>Output folder</b> is the default folder where exported Excel workbooks are save if no other folder is specified.
</li>
<li><b>Import backup folder</b> holds backups of every imported Excel
workbook. A copy of the Excel workbook is saved with with time
and date stamps attached to its name.
</li>
</ul>

<div class="note">
<ul class="org-ul">
<li>Data in the <a href="#sec-1">General information frame</a> are only editable from the scripts, not from the GUI.
</li>
<li>Only the <b>Export</b> folder is editable through the export panel.
</li>
</ul>

</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Importing questionnaire to the database</h2>
<div class="outline-text-2" id="text-2">
<p>
Two ways exist to importing questionnaires. 
</p>
<ol class="org-ol">
<li><b>Importing a single questionnaire</b> is done by clicking on the
<code>Browse..</code> button that is adjacent to <code>file</code> label. Select a file and then click the adjacent <code>Import</code> button.
</li>
<li><b>Importing a folder of questionnaires</b> is done by clicking on
<code>Browse..</code> button that is adjacent to <code>folder</code> label. Select a folder and then click on the adjacent <code>Import</code> button.
</li>
</ol>

<p>
In both cases, each file is first validated with pre-precessing checks
to make sure that it conforms with the coding scheme. Validation logs
will appear in the <a href="#sec-4">Status</a> frame and also a report is written in the
<code>Log folder</code>.
</p>

<p>
For more details about the pre-processing report please refer to
<a href="#sec-5">5</a> section.
</p>

<div class="note">
<ul class="org-ul">
<li>Note that only files with <code>.xlsx</code> extensions are imported.
</li>
<li>All imported files are copied to the <code>Export</code> subfolder with
time and data stamps attached to their names to indicate the time of importing.
</li>
</ul>

</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Exporting data to Excel</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> Choosing a country name, year and series</h3>
<div class="outline-text-3" id="text-3-1">
<p>
The <code>Country</code> drop-down list will only show names of countries with
data already in the database. This drop-down list has a live connection to the database, thus if one imports a questionnaire for a new country as shown in a <a href="#sec-2">previous section</a>, the country's name should appear in the drop-down list.
</p>

<p>
Once a country name is selected, the <code>Year</code> drop-down list shows years
with available questionnaire data for the selected country. 
</p>

<p>
The series drop-down list has three options:
</p>
<ol class="org-ol">
<li>Reported (REP): where the original questionnaire is
inserted,given that no person has changed or modified any of
the data in this series. It is advised to only modify data in
the Observed series.
</li>
<li>Observed (OBS): where the persons could modify and validate the
data. 
</li>
<li>Estimated (EST): where the disseminated data set should be.
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Moving data between series</h3>
<div class="outline-text-3" id="text-3-2">
<p>
An original questionnaire is always imported to the Reported series, to move it the Observed or Estimated series, choose first the country and year, and then click on the button in the <code>Move between databases</code> frame.
</p>

<p>
<code>REP to OBS</code> would move the data from Reported to Observed series.
</p>

<p>
<code>OBS to EST</code> would move the data from the Observed to Estimated series.
</p>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> Exporting options</h3>
<div class="outline-text-3" id="text-3-3">
<div class="important">
<p>
This section is important because is contains many necessary details to understand how the whole GUI works.
</p>

</div>

<p>
There are three ways to export the data, sheet only, table only and
alphanumeric code only. Each way has its own down-down list.
</p>
<ol class="org-ol">
<li>Sheet: a drop-down list of all exportable questionnaire sheet names. Once a sheet is selected click on the adjacent <code>Export</code> button to export it to a new Excel workbook. To export all available sheets select <code>All</code> from the drop-down list.
</li>
<li>Table: a drop-down list with all tables of the questionnaire. By selecting one and clicking on the adjacent <code>Export</code> button an new Excel workbook is created that holds the selected table.
</li>
<li>AC: a drop-down list with all alphanumeric codes (AC) that are in the questionnaire. By selecting one and clicking on the adjacent <code>Export</code> button a new Excel workbook is created that holds the data.
</li>
</ol>

<div class="note">
<p>
The exported workbooks are by default saved to <code>Export</code> subfolder with
the naming convention <code>County Name-Year-Exported Variable-Series.xlsx</code>. Users
can change where to save exported files by selecting a folder in the option
<code>Select output folder</code> as seen in the <code>Exporting data to Excel</code> frame
in Figure <a href="#fig:RM_GUI">1</a>. 
</p>

</div>

<p>
Also there are two viewing modes, an <code>Edit</code> and a <code>Read only</code> mode. 
</p>
<ol class="org-ol">
<li><code>Edit</code> mode: allows users to edit the data, comments and
inclusions in the Excel sheet and re-import them to the
database as shown in <a href="#sec-2">Importing questionnaire to the database</a>
section. This works by preserving the table locations exactly
where they are in the original questionnaire. Users will notice
that created Excel workbook looks very similar to the original
questionnaire. <b>DO NOT</b> move tables from their original
location, change the sheet name, or delete any of the data in
the configuration panel in the top left corner as seen in
Figure <a href="#fig:exportConfig">2</a>. You are only allowed to modify cell
figures, comments and inclusions. The configuration panel is
necessary to re-import the data.
</li>
<li><code>Read only</code> mode: facilitates the viewing of the data by
shifting tables to the left part of the Excel worksheet to
avoid unnecessary scrolling. However, the mode will not allow
users to re-import the data back in the database, since the
tables or alphanumeric codes are not in the exact location as
they are in the original questionnaire.
</li>
</ol>


<div id="fig:exportConfig" class="figure">
<p><img src="./img/exportConfig.png" alt="exportConfig.png" />
</p>
<p><span class="figure-number">Figure 2:</span> Screen shot of the top left corner of an exported Excel sheet which shows the configuration panel.</p>
</div>

<div class="note">
<p>
The viewing mode is chosen by the software. It is set to <code>Edit</code> mode
if a sheet or the whole questionnaire is exported, otherwise it is set
to <code>Read only</code> mode. Users can know the mode by looking at the
configuration panel in any Excel sheet as seen in Figure <a href="#fig:exportConfig">2</a>.
</p>

</div>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Status frame and Log subfolder</h2>
<div class="outline-text-2" id="text-4">
<p>
The <code>Status</code> frame is a read-only text box that prints errors and
status of procedures. Some of the outputs are also recorded in the
<code>Log</code> subfolder see the <a href="#sec-5">next</a> section.
</p>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Processing report</h2>
<div class="outline-text-2" id="text-5">
<p>
A pre-processing report is created every time one attempts to import a
questionnaire. It includes all confirmations and errors and have the naming convention as <code>RM-Country Name-Year-Series-Data-Type-Time-Date.txt</code>. Some the data included in the report is also printed in the <a href="#sec-4">Status</a> frame and <code>Log</code> subfolder.
</p>

<p>
The idea of the pre-processing report is to list errors and data
problems exist before inserting the questionnaire. Only if all the
data checks pass the questionnaire is imported.
</p>

<p>
The pre-processing step validates the below conditions, all failed
conditions are printed to the <a href="#sec-4">Status</a> frame to a log file
in the <code>Log</code> subfolder.
</p>
<ol class="org-ol">
<li>If the import is in the original questionnaire format
<ul class="org-ul">
<li>all checks in the <code>Checking sheet</code> must be passed. 
</li>
</ul>
</li>
<li>If the import is <b>not</b> in the original questionnaire format
<ul class="org-ul">
<li>worksheet must be in <code>Edit</code> mode
</li>
<li>no data cell is empty
</li>
<li>all cells must have proper coding, that is <code>X</code> for inclusion,
<code>m</code> for missing, <code>Z</code> for inapplicable
</li>
<li>all columns must sum to the national level total
</li>
<li>all sub-category must sum to the total. For example, public
and private data must sum to the total of public and private
</li>
<li>all partial category data must be less than or equal to
totals. For example, female data must be less than or equal
to total of male and female
</li>
<li>data in configuration panel must be correct, that is country
name, code, year and no. of administrative divisions
</li>
<li>tables and column numbers must be in the correct place
</li>
</ul>
</li>
</ol>
</div>
</div>


<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> A complete example</h2>
<div class="outline-text-2" id="text-6">
</div><div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1"><span class="section-number-3">6.1</span> Importing the original questionnaire</h3>
<div class="outline-text-3" id="text-6-1">
<p>
To give an example consider importing a made-up questionnaire say for <code>Laos</code> for year <code>2015</code> that
is saved in a file <code>Desktop/Example/LAOS-2015-Regional_Survey.xlsx</code>, as seen in
Figure <a href="#fig:laosDesktop">3</a>. First start the <code>RM_GUI.py</code> select the file
and click the adjacent <code>Import</code>. The <a href="#sec-4">Status</a> frame should show
</p>


<div id="fig:laosDesktop" class="figure">
<p><img src="./img/LAOS_desktop.png" alt="LAOS_desktop.png" />
</p>
<p><span class="figure-number">Figure 3:</span> Laos original questionnaire submission.</p>
</div>

<pre class="example">
Importing C:/Users/myUser/Desktop/Example/LAOS-2015-Regional_Survey.xlsx
Date: 08/03/15
Questionnaire path: C:/Users/myUser/Desktop/Example/LAOS-2015-Regional_Survey.xlsx
All the checks passes. QUESTIONNAIRE CAN BE PROCESSED
Import successful...Done
</pre>

<p>
This implies the import is successfully. In addition a backup file and a
log file are creates in:
</p>
<ul class="org-ul">
<li>backup file: <code>RMS\Import\RM_Lao People's Democratic
   Republic_2015_15-08-08-21-54.xlsx</code>
</li>
<li>log file: <code>RMS\Log\Lao People's Democratic Republic_15-08-08-21-54.log</code>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-6-2" class="outline-3">
<h3 id="sec-6-2"><span class="section-number-3">6.2</span> Moving to and exporting from the Observed series.</h3>
<div class="outline-text-3" id="text-6-2">
<p>
After a successful original import, one can move the data from
<i>Reported</i> to <i>Observed</i> series. Notice that Laos now appears in the <code>Country</code> drop-down
list. Select <code>Laos</code> and the corresponding year, then
click on <code>REP to OBS</code> button. The <a href="#sec-4">Status</a> frame should show <a href="#fig:laosREP2CLN">this</a>.
</p>


<div id="fig:laosREP2CLN" class="figure">
<p><img src="./img/LAOS_moveCLN.png" alt="LAOS_moveCLN.png" />
</p>
<p><span class="figure-number">Figure 4:</span> Laos data moved from REP to OBS.</p>
</div>

<p>
Now, let's export <code>Teachers ISCED 2</code> for cleaning. Select the country,
year and series from the drop-down lists and from the <code>Sheet</code>
drop-down list select <code>Teachers ISCED 2</code> and before clicking on the
adjacent <code>Export</code> button, select the <code>output folder</code> to be your
<code>Desktop</code>. The <a href="#sec-4">Status</a> frame will have the confirmation seen in box
<a href="#src:export_clean">1</a>, and the Excel workbook should look like <i>this</i>. Notice the configurations in the top left corner, where the mode is <code>Edit</code> and the series is <code>OBS</code>. 
</p>

<pre class="example" id="src:export_clean">
Exporting Teachers ISCED 2 from OBS series for Lao People's Democratic Republic-2015....
File C:/Users/myUser/Desktop/Example/Lao People's Democratic Republic_2015_Teachers ISCED 2_OBS.xlsx is created..
Done.
</pre>


<div id="fig:export_clean" class="figure">
<p><img src="./img/export_clean.png" alt="export_clean.png" />
</p>
<p><span class="figure-number">Figure 5:</span> Exported Laos data from observed series.</p>
</div>
</div>
</div>

<div id="outline-container-sec-6-3" class="outline-3">
<h3 id="sec-6-3"><span class="section-number-3">6.3</span> Cleaning and re-importing</h3>
<div class="outline-text-3" id="text-6-3">
<p>
As mentioned before as long as the configuration panel is left
untouched and all tables are not moved, one can go ahead and change
the data, inclusion codes and insert cell and table comments. For
example, assume for some reason Laos-2015 data we prefer to only
report the data under <code>T.2.GPV.Pu</code> in
col 2  and not to report <code>T.2.GPV.Pu.F</code> in column 3. We do this by
inclusion code.  Also we add a comment that the data
is aggregated by programme team. See Figure <a href="#fig:laos_mod">6</a> and compare it to Figure
<a href="#fig:export_clean">5</a>.
</p>


<div id="fig:laos_mod" class="figure">
<p><img src="./img/laos_mod.png" alt="laos_mod.png" />
</p>
<p><span class="figure-number">Figure 6:</span> Modified Laos data from observed series.</p>
</div>

<p>
<b>To import</b> follow similar step as in Section <a href="#sec-2">2</a>. Start the <code>RM_GUI</code> select the modified file and import
 it. If successful the <a href="#sec-4">Status</a> frame should show
</p>

<pre class="example">
Importing C:/Users/myUser/Desktop/Example/Lao People's Democratic Republic_2015_Teachers ISCED 2_OBS.xlsx
Import successful...Done
</pre>

<p>
otherwise it would list validation errors such as.
</p>

<pre class="example">
Pre-processing validation failed. Some errors exist see log file in:
Log
Importing C:/Users/myUser/Desktop/Example/Lao People's Democratic Republic_2015_Teachers ISCED 2_OBS.xlsx
Column 14 in table Table 2.2 has improper values.
</pre>

<p>
Since import is successful a backup file and log file are also creates
</p>
<ul class="org-ul">
<li>backup file: <code>RMS\Import\RM_Lao People's Democratic Republic_2015_15-08-08-22-10.xlsx</code>
</li>
<li>log file: <code>RMS\Log\Lao People's Democratic Republic_15-08-08-22-10.log</code>
</li>
</ul>

<p>
Now if you re-export the whole questionnaire, <code>Teachers ISCED 2</code>
sheet, or only <code>Table 2.1</code> from the observed series, you should be
able to see the changes and comments made earlier.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: August 10, 2015</p>
<p class="author">Author: Mohamad Elmasri</p>
<p class="date">Created: 2015-08-12 Wed 15:23</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.4.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
