<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Regional Module User Manual</title>
<!-- 2016-03-08 Tue 08:52 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Mohamad Elmasri and Oscar Quijano" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="css/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="css/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="css/styles/lib/js/bootstrap.min.js"></script>
<script type="text/javascript" src="css/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Regional Module User Manual</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Regional Module Graphical User Interface (GUI)</a>
<ul>
<li><a href="#sec-1-1">1.1. General information</a></li>
<li><a href="#sec-1-2">1.2. Importing questionnaire to the database</a></li>
<li><a href="#sec-1-3">1.3. Exporting data or indicators to Excel</a>
<ul>
<li><a href="#sec-1-3-1">1.3.1. Choosing a country name, year and series</a></li>
<li><a href="#sec-1-3-2">1.3.2. Moving data between series</a></li>
<li><a href="#sec-1-3-3">1.3.3. Exporting data options</a></li>
<li><a href="#sec-1-3-4">1.3.4. Viewing modes</a></li>
<li><a href="#sec-1-3-5">1.3.5. Calculating indicators and exporting</a></li>
<li><a href="#sec-1-3-6">1.3.6. Record format exporting</a></li>
<li><a href="#sec-1-3-7">1.3.7. Deleting data</a></li>
</ul>
</li>
<li><a href="#sec-1-4">1.4. Validation report</a></li>
<li><a href="#sec-1-5">1.5. Data report</a></li>
<li><a href="#sec-1-6">1.6. Audit trail</a>
<ul>
<li><a href="#sec-1-6-1">1.6.1. Data audit trail</a></li>
<li><a href="#sec-1-6-2">1.6.2. Indicator audit trail</a></li>
</ul>
</li>
<li><a href="#sec-1-7">1.7. A complete example</a>
<ul>
<li><a href="#sec-1-7-1">1.7.1. Inserting the original questionnaire</a></li>
<li><a href="#sec-1-7-2">1.7.2. Moving to and exporting from the Observed series.</a></li>
<li><a href="#sec-1-7-3">1.7.3. Cleaning and reinserting</a></li>
<li><a href="#sec-1-7-4">1.7.4. Calculating indicators</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-2">2. Indicators</a>
<ul>
<li><a href="#sec-2-1">2.1. Percentage of female teachers</a></li>
<li><a href="#sec-2-2">2.2. Percentage of newly recruited teachers</a></li>
<li><a href="#sec-2-3">2.3. Pupils teachers ratio</a></li>
<li><a href="#sec-2-4">2.4. Percentage of trained teachers</a></li>
<li><a href="#sec-2-5">2.5. Percentage of private teachers</a></li>
<li><a href="#sec-2-6">2.6. Percentage of non-permanent teachers</a></li>
<li><a href="#sec-2-7">2.7. Percentage of permanent teachers</a></li>
<li><a href="#sec-2-8">2.8. Attrition rate</a></li>
<li><a href="#sec-2-9">2.9. Mean age</a></li>
<li><a href="#sec-2-10">2.10. Mean years of experience</a></li>
<li><a href="#sec-2-11">2.11. Highest level of educational attainment</a></li>
<li><a href="#sec-2-12">2.12. Percentage of teachers by years of experience</a></li>
<li><a href="#sec-2-13">2.13. Percentage of teachers by age</a></li>
<li><a href="#sec-2-14">2.14. Dissimilarity index</a></li>
</ul>
</li>
<li><a href="#sec-3">3. Adding  Indicators</a>
<ul>
<li><a href="#sec-3-1">3.1. The indicators class</a></li>
<li><a href="#sec-3-2">3.2. Setup template</a></li>
<li><a href="#sec-3-3">3.3. Column operation</a></li>
<li><a href="#sec-3-4">3.4. Example</a></li>
</ul>
</li>
<li><a href="#sec-4">4. Code Documentation</a>
<ul>
<li><a href="#sec-4-1">4.1. Processing a questionnaire</a>
<ul>
<li><a href="#sec-4-1-1">4.1.1. Preprocessing</a></li>
<li><a href="#sec-4-1-2">4.1.2. Data and comments extraction</a></li>
</ul>
</li>
<li><a href="#sec-4-2">4.2. Computing indicators</a></li>
<li><a href="#sec-4-3">4.3. Exporting data</a>
<ul>
<li><a href="#sec-4-3-1">4.3.1. Exporting questionnaire data</a></li>
<li><a href="#sec-4-3-2">4.3.2. Exporting indicators</a></li>
</ul>
</li>
<li><a href="#sec-4-4">4.4. Software folder tree</a></li>
<li><a href="#sec-4-5">4.5. Python help files</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="fig:RM_GUI" class="figure">
<p><img src="./img/RM_GUI.png" alt="RM_GUI.png" />
</p>
<p><span class="figure-number">Figure 1:</span> Screen shot of RM_GUI.</p>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Regional Module Graphical User Interface (GUI)</h2>
<div class="outline-text-2" id="text-1">
<p>
This document explains how to use the Regional Module (RM) questionnaire management system (RMS) GUI. There are four main frames in the GUI that could be seen in Figure <a href="#fig:RM_GUI">1</a>.
</p>
<ul class="org-ul">
<li><a href="#sec-1-1">General information</a>: general session and user information as
the user name and database location, main working directory, ..etc. 
</li>
<li><a href="#sec-1-2">Importing questionnaire to the database</a>: tools to
import or validate a single questionnaire.
</li>
<li><a href="#sec-1-3">Exporting data or indicators to Excel</a>: tools to export and visualize the
raw data or indicators that are already in the database.
</li>
<li><b>Status</b>: a panel that outputs updates on the carried procedures, including any errors. Shown in the bottom of the interface.
</li>
</ul>

<div class="sidebar">
<p>
In this guide you will learn to:
</p>
<ul class="org-ul">
<li>Import questionnaires.
</li>
<li>Export and and view data for cleaning.
</li>
<li>Move data between series.
</li>
<li>Calculate and view indicators.
</li>
</ul>

</div>
<p>
Each frame, excluding the Status panel, has a specific subsection below that explains in details how to use the available tools.
</p>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> General information</h3>
<div class="outline-text-3" id="text-1-1">
<p>
This frame holds information that are essential for all tools in other frames, and will be used all over this guide.
</p>

<ul class="org-ul">
<li><b>User</b> prints the automatically retrieved user name from the
windows login information. This user name is used to track user
changes to the data as will be later explained.
</li>
<li><b>Main working directory</b> is the path of the main folder where
all the other mentioned sub-folders are located. Basically, it is
the folder that contains all the software, from code to documentation. For more details see <a href="#sec-4-4">Software folder tree</a>.
</li>
<li><b>Database</b> shows the path to the physical database (<code>.db</code> file). In Figure <a href="#fig:RM_GUI">1</a>, it is in the sub-folder <code>Database</code> of
the main folder as indicated by <code>/Database/Prod.db</code>. For example, if
the main directory is <code>/Desktop/RMS</code> then the database file is
at <code>/Desktop/RMS/Database/Prod.db</code>.   
</li>
<li><b>Log folder</b> holds validation and data reports every time a user
attempts to validate, check only or insert the data. It is also a sub-folder of
the main directory. See Sections <a href="#sec-1-4">1.4</a>  and <a href="#sec-1-5">1.5</a> for more details.
</li>
<li><b>Output folder</b> is the default folder where exported Excel
workbooks are saved if no other folder is specified. <i>Note that you can specify another output folder, see note in <a href="#sec-1-3-3">Exporting data options</a>.</i>
</li>
<li><b>Import backup folder</b> holds backups of every inserted Excel
workbook. A copy of the Excel workbook is saved with time
and date stamps attached to its name.
</li>
</ul>

<div class="note">
<ul class="org-ul">
<li>Data in the <a href="#sec-1-1">General information frame</a> are only editable from the scripts, not from the GUI.
</li>
<li>Only the <b>Output folder</b> folder is editable through the export panel, see note in <a href="#sec-1-3-3">Exporting data options</a>.
</li>
</ul>

</div>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Importing questionnaire to the database</h3>
<div class="outline-text-3" id="text-1-2">
<p>
To Insert a questionnaire to the database, follow these steps:
</p>
<ol class="org-ol">
<li>Click on the <code>Browse..</code> button that is adjacent to <code>file</code>
       label and select a file.
</li>
<li>Validate the file by clicking on <code>Validate</code> button, since there
are specific pre-processing checks to make sure that it
conforms with the coding scheme. If the checks are passed, the
Status panel will indicate with a note on the lines of 
<pre class="example">
Validation successful, see report in:
Log/Lao People's Democratic Republic_16-01-22-11-33_validation.txt
</pre>
<p>
otherwise on the lines of
</p>
<pre class="example">
Pre-processing validation failed. Some errors exist see log file in:
Log/Lao People's Democratic Republic_16-01-22-11-35_validation.txt
</pre>
<p>
In both cases a validation report is saved in the <code>Log folder</code>, and
should automatically open if the box <code>Open validation report</code> is ticked.
</p>
</li>
<li>If validation passed, insert the questionnaire by clicking on
<code>Insert</code>. The file is inserted to the database and a <code>csv</code> data report is
generated and saved in the <code>Log folder</code>, and also should
automatically open if the box named <code>Open data report</code> is
ticked. A note on the lines of will appear in the Status panel.
<pre class="example">
INSERTION STEP

Inserting C:/Users/Mohamad/Documents/GitHub/RMS/Import/
            RM_Lao People's Democratic Republic_2015_15-11-19-23-46.xlsx
Checking that region values add to the country value...Test passed.
Checking that parts are less than the totals...Test passed.
Checking sums of columns...
----------Questionnaire Insertion finished.----------.

Data report written to: 
Log/Lao People's Democratic Republic_16-01-22-11-40_data_report.csv
</pre>
</li>
</ol>


<p>
The steps above are simplified. For more details about the
pre-processing checks and data report please refer to Sections <a href="#sec-1-4">1.4</a> and <a href="#sec-1-5">1.5</a>.
</p>

<div class="note">
<ul class="org-ul">
<li>Only files with <code>.xlsx</code> extensions are inserted.
</li>
<li>A copy of any inserted file is saved to the <code>Export</code> sub-folder with
time and data stamps attached to their names to indicate the
time of inserting.
</li>
<li>All validation files and data reports are saved to the <code>Log folder</code>,
while some information is shown in the Status panel.
</li>
</ul>

</div>

<p>
<b>About the checkboxes:</b>
</p>
<ul class="org-ul">
<li><b>Import to REP</b> is a security checkbox that stops the user from
inserting to the reported series (REP) by mistake. It is
unticked by default, and works as follows, if the user attempts
to insert some data to the reported series, even if the file
validates, the user is not allowed unless this checkbox is
ticked. Only under one exception it is allowed, if the inserted   
file is an original questionnaire, this becomes more clear in
<a href="#sec-1-3-3">Exporting data options</a>.
</li>
<li><b>Open validation report</b> is a checkbox that is ticked by default to
automatically open the validation report resulting from the validation
step. Feel free to untick it as all the validation reports are saved in
the <code>Log folder</code>.
</li>
<li><b>Open data report</b> is a checkbox that is ticked by default to
automatically open the date report resulting after inserting a
questionnaire. Feel free to untick it since all data reports are
saved to the <code>Log folder</code>.
</li>
</ul>

<p>
Finally, the button <b><code>Check only</code></b> allows the user to produce a data
report without validating nor inserting the data. The objective is to
streamline the cleaning process before finally inserting the data. 
</p>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> Exporting data or indicators to Excel</h3>
<div class="outline-text-3" id="text-1-3">
</div><div id="outline-container-sec-1-3-1" class="outline-4">
<h4 id="sec-1-3-1"><span class="section-number-4">1.3.1</span> Choosing a country name, year and series</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
The <code>Country</code> drop-down list will only show names of countries with
data already in the database. This drop-down list has a live connection to the database, thus if one inserts a questionnaire for a new country, as shown in a <a href="#sec-1-2">Importing questionnaire to the database</a>, the country's name should appear in the drop-down list directly.
</p>

<p>
Once a country name is selected, the <code>Year</code> drop-down list shows years
with available questionnaire data for the selected country. 
</p>

<p>
The series drop-down list has three options:
</p>
<dl class="org-dl">
<dt> Reported (REP) </dt><dd>where the original questionnaire is
inserted, given that no person has changed or modified any of
the data in this series. It is advised to only modify data in
the Observed series, thus the checkbox <code>Import to REP</code> is created.
</dd>
<dt> Observed (OBS) </dt><dd>where the user is advised to modify and validate the
data. 
</dd>
<dt> Estimated (EST) </dt><dd>where the disseminated data set should be,
<b>since the indicators are calculated from this series only</b>.
</dd>
</dl>
</div>
</div>

<div id="outline-container-sec-1-3-2" class="outline-4">
<h4 id="sec-1-3-2"><span class="section-number-4">1.3.2</span> Moving data between series</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
An original questionnaire is always inserted to the <i>Reported</i> series, to move it the <i>Observed</i> or <i>Estimated</i> series, choose first the country and then year, and then click on the buttons in the <code>Move databases</code> frame.
</p>

<ul class="org-ul">
<li><code>REP to OBS</code> would move the data from <i>Reported</i> to <i>Observed</i> series.
</li>
<li><code>OBS to EST</code> would move the data from <i>Observed</i> to <i>Estimated</i> series.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-3-3" class="outline-4">
<h4 id="sec-1-3-3"><span class="section-number-4">1.3.3</span> Exporting data options</h4>
<div class="outline-text-4" id="text-1-3-3">
<div class="important">
<p>
This section is important because it contains many necessary details to understand how the whole GUI works.
</p>

</div>

<p>
There are three ways to export data, sheet only, table only and
alphanumeric code (AC) only. Each way has its own drop-down list.
</p>
<dl class="org-dl">
<dt> Sheet </dt><dd>A drop-down list of all exportable questionnaire sheet names. Once a sheet is selected click on the adjacent <code>Export</code> button to export it to a new Excel workbook. To export all available sheets select <code>All</code> from the drop-down list.
</dd>
<dt> Table </dt><dd>A drop-down list with all tables of the questionnaire. By selecting one and clicking on the adjacent <code>Export</code> button a new Excel workbook is created that holds the selected table.
</dd>
<dt> AC </dt><dd>A drop-down list with all ACs that are in the questionnaire. By selecting one and clicking on the adjacent <code>Export</code> button a new Excel workbook is created that holds the data.
</dd>
</dl>

<div class="note">
<ul class="org-ul">
<li>The exported workbooks are by default saved to <code>Export</code> sub-folder of the main directory, with the naming convention <code>County Name-Year-Exported Variable-Series.xlsx</code>. 
</li>
<li>Users can change where to save exported files by selecting a folder in the option <code>Select output folder</code> as seen in the <code>Exporting data to Excel</code> frame in Figure <a href="#fig:RM_GUI">1</a>. If the user selects another output folder than <code>Export</code>, only exported questionnaire data is placed there. Validation and data reports will still be saved to the log sub-folder <code>Log</code>.
</li>
</ul>

</div>
</div>
</div>

<div id="outline-container-sec-1-3-4" class="outline-4">
<h4 id="sec-1-3-4"><span class="section-number-4">1.3.4</span> Viewing modes</h4>
<div class="outline-text-4" id="text-1-3-4">
<p>
When any data is exported, they are exported based on two viewing modes, an <code>Edit</code> and a <code>Read only</code> mode. 
</p>
<dl class="org-dl">
<dt> <code>Edit</code> mode </dt><dd>allows users to edit the data, comments and
inclusions in the Excel sheet and reinsert them to the database
as shown in <a href="#sec-1-2">Importing questionnaire to the database</a>
section. This works by preserving the table locations exactly
where they are in the original questionnaire. Users will notice
that the created Excel workbooks look very similar to the original
questionnaire. <b>Do not move tables from their original locations, reorder or change names of administrative divisions, change the sheet names, or delete any of the data in
the configuration panel</b>; in the top left corner as seen in
Figure <a href="#fig:exportConfig">2</a>. You are only allowed to modify cell
figures, comments and inclusions. The configuration panel is
necessary to reinsert the data, without it the validation would
fail and modifying it might harm the functionality of the
software.
</dd>
<dt> <code>Read only</code> mode </dt><dd>facilitates the viewing of the data by
shifting tables to the left part of the Excel worksheet to
avoid unnecessary scrolling. However, the mode will <b>not allow users to reinsert the data</b> back in the database, since the
tables or Acs are not in the exact location as
they are in the original questionnaire. If users attempt to
insert a <code>Read only</code> mode file, the validation step will fail,
hence not allowed to import.
</dd>
</dl>


<div id="fig:exportConfig" class="figure">
<p><img src="./img/exportConfig.png" alt="exportConfig.png" />
</p>
<p><span class="figure-number">Figure 2:</span> Screen shot of the top left corner of an exported Excel sheet which shows the configuration panel.</p>
</div>

<div class="important">
<ul class="org-ul">
<li>The viewing mode is chosen by the software. It is set to <code>Edit</code>
mode if a sheet or the whole questionnaire is exported,
otherwise it is set to <code>Read only</code> mode. Users can know the
mode by looking at the configuration panel in any Excel sheet
as seen in Figure <a href="#fig:exportConfig">2</a>.
</li>
<li>Users are only allowed to select from the drop-down list, or
type manually the names of sheets, tables or ACs. If the users type anything else, the
software will reject it. 
</li>
</ul>

</div>
</div>
</div>

<div id="outline-container-sec-1-3-5" class="outline-4">
<h4 id="sec-1-3-5"><span class="section-number-4">1.3.5</span> Calculating indicators and exporting</h4>
<div class="outline-text-4" id="text-1-3-5">
<p>
Before exporting any indicators, we need to calculate them. For the
selected country and year the <code>Calculate</code> button in the indicator
sub-frame will calculate all indicators from the data in the
<i>Estimated</i> series. Therefore, users must make sure that data exist in
the <i>Estimated</i> series, once the data is there, select <i>Estimated</i> in the Series drop-down list and click on <code>Calculate</code>. Once all indicators are calculated, users can
extract them using one of the following methods
</p>
<dl class="org-dl">
<dt> Direct extraction </dt><dd>By selecting from the drop-down list or
typing the indicator ID (IND_ID) and clicking on the adjacent <code>Extract</code>
button. To extract all indicators select or type <code>All</code>.
</dd>
<dt> Wildcard </dt><dd>Since the huge list of indicators, users can
extract groups of indicators using name patterns, where <code>%</code>
substitutes for zero or more characters and <code>_</code> substitutes for
a single character. For example,
<ul class="org-ul">
<li>to extract all indicators for teachers of ISCED 1 in the
public sector you can type <code>%T.1.Pu%</code>, since all requested
indicators have the pattern <code>T.1.Pu</code> in their name.
</li>
<li>to extract all the percentage of teachers with ISCED 2 or
less qualification in all ISCED levels, type <code>EA2m%</code>, since
all of them start with the pattern <code>EA2m</code>. If the interest is
in the public sector only, type <code>EA2m%.Pu</code>.
</li>
<li>to extract the percentage of female teachers in ISCED levels 1, 2, and 3,
but not 2 and 3, type <code>FT._</code>, since all have the pattern
<code>FT.</code> in their name and <code>_</code> substitutes for a single character.
</li>
</ul>
</dd>
</dl>
<p>
Note that wildcards are only applicable to indicator extraction, not
raw data.
</p>


<div class="note">
<ul class="org-ul">
<li>Similar to the extraction of raw data, indicators are extracted
for the selected country and year, for all administrative
divisions. Thus even if you select a single indicator to
extract, the result is a table of one column and a number of
rows corresponding to the number of administrative divisions plus
the national level. 
</li>
<li>Some indicators, for example the max and min of an indicator, is
only calculated for the national level, nonetheless, the
extraction would result in a table of 1 column and all the
administrative division cells are empty, while the national level
holds the indicator figure.
</li>
<li>If indicators are incalculable because of missing data or
inclusions, the figure will be replaced by resulting magnitude code in the respective cell. <b>If the cell is empty, either the
indicator is a national level indicator or the <i>Estimated</i> series is empty.</b>
</li>
<li>To understand indicator magnitude see <a href="#sec-3-3">Column operation</a> section for the discussion on algebras.
</li>
<li>Indicators are always sorted alphabetically.
</li>
<li>Exported indicator files follow the naming convention <code>County Name-Year-Indic-indicator name.xlsx</code>, when the use of wildcards, <code>%</code> is replaced with <code>xx</code>.
</li>
</ul>

</div>

<p>
For the current version of the software, these are the list of calculated indicators:
</p>
<ul class="org-ul">
<li>Percentage of female teachers
</li>
<li>Percentage of newly recruited teachers
</li>
<li>Pupils teachers ratio
</li>
<li>Percentage of trained teachers
</li>
<li>Percentage of private teachers
</li>
<li>Percentage of non-permanent teachers
</li>
<li>Attrition rate
</li>
<li>Mean age
</li>
<li>Mean years of experience
</li>
<li>Highest level of educational attainment
</li>
<li>Percentage of teachers by years of experience
</li>
<li>Percentage of teachers by age
</li>
<li>Dissimilarity index
</li>
</ul>

<p>
For more details about the computational methods refer to <a href="#sec-2">Indicators</a> section.
</p>
</div>
</div>

<div id="outline-container-sec-1-3-6" class="outline-4">
<h4 id="sec-1-3-6"><span class="section-number-4">1.3.6</span> Record format exporting</h4>
<div class="outline-text-4" id="text-1-3-6">
<p>
Record format exporting, in the frame <code>Direct SQL extraction:</code>, allows an easy access to the SQL database, for raw data and indicators. Basically, each data figure will appear in its own row, with the corresponding dimensions, 
</p>
<ul class="org-ul">
<li>CO_SHORT_NAME: the country short name,
</li>
<li>CO_CODE: the country code,
</li>
<li>ADM_NAME: the administrative division name,
</li>
<li>YEAR: data reference year,
</li>
<li>MC_ID: the numerical version of the AC code, only for raw data,
</li>
<li>AC: the alphanumeric code of the raw data or indicator,
</li>
<li>FIG: the actual figure.
</li>
</ul>

<p>
To extract data, you need to use the following input format in the given text box of the  <code>Direct SQL extraction:</code> frame: 
</p>

<pre class="example">
type-series[co_code1(adm1, adm2, ...); co_code2(adm1, adm2, ...); ...; YEAR; AC]
</pre>

<p>
where 
</p>
<dl class="org-dl">
<dt> type </dt><dd>is either <code>raw</code> to extract raw data, or <code>indic</code> to extract indicators.
</dd>
<dt> series (optional) </dt><dd>is either <code>rep</code>, <code>obs</code> or <code>est</code>, the default is <code>est</code> as in the case for indicators.
</dd>
<dt> co_code (optional) </dt><dd>you can pass a series of country codes with the following possible formats:
<ul class="org-ul">
<li>co_code      := for all administrative divisions for this country. 
</li>
<li>co_code(1)   := for administrative division code 1 for this country.
</li>
<li>co_code(0)   := for the national level data only for this country.
</li>
<li>co_code(0,1) := for the national level data and administrative division code 1 for this country.
</li>
<li>leave empty  := as indicated by (optional), it will extract all countries and administrative  divisions in the database.
</li>
<li>any wrong co_code is ignored.
</li>
</ul>
</dd>
<dt> YEAR (optional) </dt><dd>you can pass years in the following formats:
<ul class="org-ul">
<li>yyyy         := for a specific year, as 2014 or 2015.
</li>
<li>yyyy:yyyy    := for a range of years, as 2013:2015, would extract all data between 2013 and 2015, inclusive.
</li>
<li>leave empty  := for all years.
</li>
</ul>
</dd>
<dt> AC </dt><dd>an exact alphanumeric code or with a wildcard must be passed. Users can extract groups of indicators or raw data using name patterns, where % substitutes for zero or more characters and _ substitutes for a single character. For examples see section <a href="#sec-1-3-5">Calculating indicators and exporting</a> on wildcards. 
</dd>
</dl>

<div class="note">
<p>
Exported data are saved in the <code>Export</code> folder if no other folder is specified, under the naming convention <code>record_format_type-series_AC.xlsx</code>, where in the case of wildcards, % is replaced with <code>xx</code>. This is indicated in the Status panel as well.
</p>

</div>

<p>
For example: 
</p>
<ul class="org-ul">
<li><code>raw-obs[4180; 2014; T.1]</code> to extract all <code>T.1</code> raw data for all administrative divisions from the <i>Observed</i> series for 2014, country 4180. If no data exist, the file would be empty.
</li>
<li><code>raw[4180(2,3,0); ; T.1]</code> to extract all <code>T.1</code> raw data from the <i>Estimated</i> series for all administrative divisions code 2, 3 and national level for 0, for country 4180, for all years.
</li>
<li><code>indic[; ; %T.2%]</code> to extract all indicators with the pattern <code>T.2</code> in their alphanumeric code, for all countries, administrative divisions and years.
</li>
<li><code>indic[;2011:2015;%T.2%]</code> to extract all indicators with the pattern <code>T.2</code> in their alphanumeric code, for all countries and administrative divisions, for years between 2011 and 2015, inclusive.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-3-7" class="outline-4">
<h4 id="sec-1-3-7"><span class="section-number-4">1.3.7</span> Deleting data</h4>
<div class="outline-text-4" id="text-1-3-7">
<p>
By selecting a country and year from the drop-down list and clicking <code>Delete questionnaire</code>, this would delete all data and indicators associated with that specific country and year. The drop-down list should not show the deleted data after a refresh.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> Validation report</h3>
<div class="outline-text-3" id="text-1-4">
<p>
A validation report is created and saved in the <code>Log</code> sub-folder
every time the user attempts to insert a questionnaire by clicking on
the <code>Validate</code> button. It includes all confirmations and errors and
have the naming convention as <code>Country
Name-Year-Series-Data Type-Date-Time.txt</code>. 
</p>

<p>
The idea of the validation is to list critical errors with
the selected file. Only if all the validation checks pass the
questionnaire is then allowed to be inserted.
</p>

<p>
The validation check the below conditions, all failed
conditions are saved and also printed to the Status panel:
</p>
<dl class="org-dl">
<dt> In case of an original questionnaire format </dt><dd>checks are
<ul class="org-ul">
<li>ADM label, i.e., Province, district etc, is filled.
</li>
<li>number of ADM is a positive integer.
</li>
<li>the ADM names are filled.
</li>
<li>the correct number of sheets are available with correct
original names.
</li>
<li>reference year is filled and an integer, from cell <code>M14</code> in
"Policy information" sheet.
</li>
<li>Any "No" in the "Checking sheet" is copied to the validation report.
</li>
</ul>
</dd>
<dt> In case of an <code>Edit</code> mode format </dt><dd>checks are
<ul class="org-ul">
<li>worksheet must be in <code>Edit</code> mode.
</li>
<li>configuration panel is properly filled.
<ul class="org-ul">
<li>no missing information.
</li>
<li>labels of configuration are in the proper order of <code>[Country, CO_CODE, Year, Data, No.ADM, Series,Mode]</code>.
</li>
<li>mode defined as "Edit".
</li>
<li>year is an integer bigger than zero.
</li>
<li>series is one of the following <code>[OBS,REP,EST]</code>.
</li>
<li>country code matches the one taken from the database using the provided country name.
</li>
<li>number of ADM is a positive integer. This variable is taken from the configuration panel, thus <b>do not change it.</b>
</li>
</ul>
</li>
</ul>
</dd>
<dt> In General </dt><dd>checks are
<ul class="org-ul">
<li>check that all data values are either a number, inclusion (X or x), Z, z, A, a, N, n, M or m. Otherwise, validation fails and error is printed.
</li>
</ul>
</dd>
</dl>

<p>
For more technical information, see <a href="#sec-4-1-1">Preprocessing</a> section.
</p>
</div>
</div>
<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> Data report</h3>
<div class="outline-text-3" id="text-1-5">
<p>
At this step if the validation checks have passed, once the user
clicks on the <code>Insert</code> button, a data report is created and saved in
the <code>Log</code> folder. If the checkbox <code>Open data report</code> is ticked, the
report will automatically open. Also users can invoke the creation
of a data report without validating or inserting the file, by
clicking on the <code>Check only</code> button. 
</p>

<p>
The data report checks the following and lists any issues: 
</p>
<dl class="org-dl">
<dt> In case of an original questionnaire format </dt><dd>checks are
<ul class="org-ul">
<li>if ADM names exists in database they must equal the ones in
the questionnaire, otherwise prints an error. This mean you
can only change ADM names after they have been created by
accessing the database directly, and if you try to reinsert the original questionnaire for the same year with reordered or changed region names, it will fail.
</li>
</ul>
</dd>
<dt> In General </dt><dd>checks are
<ul class="org-ul">
<li>all columns must sum to the national level total.
</li>
<li>all sub-category must sum to the total. For example, public
and private data must sum to the total.
</li>
<li>all partial category data must be less than or equal to
totals. For example, female data must be less than or equal
to total.
</li>
</ul>
</dd>
</dl>

<p>
Note, for all the cells that have missing data (m), inclusion (x), or inapplicable (z), the inequality or sums tests are ignored.
</p>

<p>
For more technical information, see <a href="#sec-4-1-1">Preprocessing</a> section.     
</p>
</div>
</div>
<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6"><span class="section-number-3">1.6</span> Audit trail</h3>
<div class="outline-text-3" id="text-1-6">
<p>
To keep track of changes to individual data and indicators, including figures, qualifiers, inclusion codes, and magnitudes, we have implemented an audit functionality in the backend (SQL), that records any changes to the data. This doesn't include data comments or table comments. We call this functionality <b>Audit trail</b>. Note that Audit trail tables are not accessible from the software interface (GUI), rather they function in the backend and only accessible by directly accessing the SQL database. 
</p>

<p>
There are two main tables that keep track of changes, one for raw (meter) data called <code>METER_AUDIT_TRAIL</code>, and the other for indicators called <code>INDICATOR_AUDIT_TRAIL</code>. Their structure is very similar and could be combined in one table, nevertheless, for more clarity we separated the indicators from raw data. 
</p>

<p>
In essence, every time there is a change in a data, both the old and new information is recorded with a timestamp and user name. The following two subsections discuss in more details how changes are recorded and how to understand and read these SQL tables.
</p>
</div>

<div id="outline-container-sec-1-6-1" class="outline-4">
<h4 id="sec-1-6-1"><span class="section-number-4">1.6.1</span> Data audit trail</h4>
<div class="outline-text-4" id="text-1-6-1">
<p>
<code>METER_AUDIT_TRAIL</code> is the SQL table that records changes in raw data and metadata. Basically, any time there is a change in a raw figure or its metadata, which includes magnitudes (inclusion, missing,..) and qualifiers, both the new and old figures and metadata are recorded with the change timestamp and the user name. This change happens in the cleaning process, when the user attempts to modify data directly in Excel and reinserts it into SQL. Thus every time an <code>Edit</code> mode Excel file is validated and reinserted, the data is compared to what is in the SQL database, and any changes are recorded. 
</p>

<p>
The following is the schema of the SQL table, where 
</p>
<ul class="org-ul">
<li><code>MC_ID</code> is the numeric reference of the data and corresponds to an AC.
</li>
<li><code>CO_CODE</code> is the country code.
</li>
<li><code>ADM_CODE</code> is the administrative division code.
</li>
<li><code>MC_YEAR</code> is the data year.
</li>
<li><code>EM_FIG</code> is the actual data figure.
</li>
<li><code>MQ_ID</code> is the data qualifier.
</li>
<li><code>MG_ID</code> is the data magnitude.
</li>
<li><code>SYS_DATA</code> is the internal local time to when the change has happened.
</li>
</ul>
<div class="org-src-container">

<pre class="src src-sql"><span style="color: #F92672;">CREATE</span> <span style="color: #F92672;">TABLE</span> <span style="color: #A6E22E;">METER_AUDIT_TRAIL</span>(
    Audit_ID <span style="color: #66D9EF;">Integer</span> , <span style="color: #75715E;">-- auto-increment ID</span>
    MC_ID <span style="color: #66D9EF;">decimal</span>(6, 0) <span style="color: #F92672;">NOT</span> <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">--numeric reference of the data</span>
    CO_CODE <span style="color: #66D9EF;">decimal</span>(6, 0) <span style="color: #F92672;">NOT</span> <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- country code</span>
    ADM_CODE <span style="color: #66D9EF;">INT</span> <span style="color: #F92672;">NOT</span> <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- Administrative Division code.</span>
    MC_YEAR <span style="color: #66D9EF;">decimal</span>(4, 0) <span style="color: #F92672;">NOT</span> <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- data year</span>
    EM_FIG_NEW <span style="color: #66D9EF;">varchar</span>(4000) <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- new figure</span>
    EM_FIG_OLD <span style="color: #66D9EF;">varchar</span>(4000) <span style="color: #F92672;">NULL</span>,  <span style="color: #75715E;">-- old figure</span>
    MQ_ID_NEW <span style="color: #66D9EF;">char</span>(1) <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- new qualifier</span>
    MQ_ID_OLD <span style="color: #66D9EF;">char</span>(1) <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- old qualifier</span>
    MG_ID_NEW <span style="color: #66D9EF;">char</span>(1) <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- new magnitude</span>
    MG_ID_OLD <span style="color: #66D9EF;">char</span>(1) <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- old magnitude</span>
    TYPE_MOD <span style="color: #66D9EF;">char</span>(1) <span style="color: #F92672;">NULL</span>, 
    USER_NAME <span style="color: #66D9EF;">varchar</span>(20) <span style="color: #F92672;">NOT</span> <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- user name</span>
    SYS_DATE datetime <span style="color: #F92672;">DEFAULT</span> (datetime(<span style="color: #E6DB74;">'now'</span>,<span style="color: #E6DB74;">'localtime'</span>)), <span style="color: #75715E;">--local timestamp</span>
    SERIES <span style="color: #66D9EF;">varchar</span>(10) <span style="color: #F92672;">NOT</span> <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- data series</span>
    SURVEY_ID <span style="color: #66D9EF;">char</span>(2) <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">--- Regional model default is set to 'RM'</span>
    <span style="color: #F92672;">PRIMARY</span> <span style="color: #F92672;">KEY</span> (Audit_ID <span style="color: #F92672;">ASC</span>));
</pre>
</div>

<p>
To read from the table, using <code>sqlite3</code> connect to <code>Prod.db</code> file or any other database file you are using and follow standard SQL extraction syntax as
</p>
<div class="org-src-container">

<pre class="src src-sql"><span style="color: #F92672;">SELECT</span> * <span style="color: #F92672;">from</span> METER_AUDIT_TRAIL <span style="color: #F92672;">LIMIT</span> 5;
</pre>
</div>
<p>
to see the first 5 rows of the table, and 
</p>
<div class="org-src-container">

<pre class="src src-sql"><span style="color: #F92672;">SELECT</span> a.* <span style="color: #F92672;">from</span> METER_AUDIT_TRAIL <span style="color: #F92672;">AS</span> a
<span style="color: #F92672;">LEFT</span> <span style="color: #F92672;">JOIN</span> EDU_METER_AID <span style="color: #F92672;">AS</span> b <span style="color: #F92672;">ON</span> a.MC_ID = b.EMC_ID
<span style="color: #F92672;">WHERE</span> b.AC =<span style="color: #E6DB74;">'NT.1'</span> <span style="color: #F92672;">AND</span> a.CO_CODE = 4180 <span style="color: #F92672;">AND</span> a.MC_YEAR = 2014;
</pre>
</div>
<p>
for all the changes that happened to <code>NT.1</code>, newly recruited teachers in ISCED 1, initial education, for country with code 4180 for data year 2014. Using the <code>EDU_METER_AID</code> facilitates the use of AC directly rather than the numeric representation (<code>MC_ID</code>).
</p>
</div>
</div>

<div id="outline-container-sec-1-6-2" class="outline-4">
<h4 id="sec-1-6-2"><span class="section-number-4">1.6.2</span> Indicator audit trail</h4>
<div class="outline-text-4" id="text-1-6-2">
<p>
<code>INDICATOR_AUDIT_TRAIL</code> is the SQL table that records changes in indicators and their metadata. Any time there is a change in the indicator or its metadata, which includes magnitudes and qualifiers, both the new and old figures and metadata are recorded with change timestamp and the user name. This change happens when the user changes raw data and recalculates indicators by clicking on <code>Calculate</code> button in the indicator frame. Contrary to the data audit trail, users cannot manually change indicators and reinserts them, this functionality is not supported by the software.
</p>

<p>
The following is the schema of the SQL table, where 
</p>
<ul class="org-ul">
<li><code>IND_ID</code> is the alphanumeric name of the indicator.
</li>
<li><code>CO_CODE</code> is the country code.
</li>
<li><code>ADM_CODE</code> is the administrative division code.
</li>
<li><code>IND_YEAR</code> is the indicator data year.
</li>
<li><code>FIG</code> is the actual indicator figure.
</li>
<li><code>QUAL</code> is the indicator qualifier.
</li>
<li><code>MAGN</code> is the indicator magnitude.
</li>
<li><code>SYS_DATA</code> is the internal local time to when the change has happened.
</li>
<li><code>SERIES</code> is always set to <code>EST</code> since indicators are only calculated from estimated series.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-sql"><span style="color: #F92672;">CREATE</span> <span style="color: #F92672;">TABLE</span> <span style="color: #A6E22E;">INDICATOR_AUDIT_TRAIL</span>(
        Audit_ID <span style="color: #66D9EF;">Integer</span> , <span style="color: #75715E;">-- auto-increment ID</span>
        IND_ID <span style="color: #66D9EF;">varchar</span>(50) <span style="color: #F92672;">NOT</span> <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- indicator ID</span>
    CO_CODE <span style="color: #66D9EF;">decimal</span>(6, 0) <span style="color: #F92672;">NOT</span> <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- country code</span>
    ADM_CODE <span style="color: #66D9EF;">INT</span> <span style="color: #F92672;">NOT</span> <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- Administrative Division code.</span>
        IND_YEAR <span style="color: #66D9EF;">decimal</span>(4, 0) <span style="color: #F92672;">NOT</span> <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- indicator data year</span>
        FIG_NEW <span style="color: #66D9EF;">varchar</span>(4000) <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- new figure</span>
        FIG_OLD <span style="color: #66D9EF;">varchar</span>(4000) <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- old figure</span>
        QUAL_NEW <span style="color: #66D9EF;">char</span>(1) <span style="color: #F92672;">NULL</span>,  <span style="color: #75715E;">-- new qualifier</span>
        QUAL_OLD <span style="color: #66D9EF;">char</span>(1) <span style="color: #F92672;">NULL</span>,  <span style="color: #75715E;">-- old qualifier</span>
        MAGN_NEW <span style="color: #66D9EF;">char</span>(1) <span style="color: #F92672;">NULL</span>,  <span style="color: #75715E;">-- new magnitude</span>
        MAGN_OLD <span style="color: #66D9EF;">char</span>(1) <span style="color: #F92672;">NULL</span>,  <span style="color: #75715E;">-- old magnitude</span>
        USER_NAME <span style="color: #66D9EF;">varchar</span>(20) <span style="color: #F92672;">NOT</span> <span style="color: #F92672;">NULL</span>, 
        SYS_DATE datetime <span style="color: #F92672;">DEFAULT</span> (datetime(<span style="color: #E6DB74;">'now'</span>,<span style="color: #E6DB74;">'localtime'</span>)), <span style="color: #75715E;">-- local change time</span>
        SERIES <span style="color: #66D9EF;">varchar</span>(10) <span style="color: #F92672;">NOT</span> <span style="color: #F92672;">NULL</span>, <span style="color: #75715E;">-- series is always EST</span>
    <span style="color: #F92672;">PRIMARY</span> <span style="color: #F92672;">KEY</span> (Audit_ID <span style="color: #F92672;">ASC</span>));
</pre>
</div>

<p>
To read from the table, using <code>sqlite3</code> connect to <code>Prod.db</code> file or any other database file you are using and follow standard SQL extraction syntax as
</p>
<div class="org-src-container">

<pre class="src src-sql"><span style="color: #F92672;">SELECT</span> * <span style="color: #F92672;">from</span> INDICATOR_AUDIT_TRAIL <span style="color: #F92672;">LIMIT</span> 5;
</pre>
</div>
<p>
to see the first 5 rows of the table, and 
</p>
<div class="org-src-container">

<pre class="src src-sql"><span style="color: #F92672;">SELECT</span> * <span style="color: #F92672;">from</span> INDICATOR_AUDIT_TRAIL
<span style="color: #F92672;">WHERE</span> IND_ID =<span style="color: #E6DB74;">'FTP.1'</span> <span style="color: #F92672;">AND</span> CO_CODE = 4180 <span style="color: #F92672;">AND</span> IND_YEAR = 2014;
</pre>
</div>
<p>
for all the changes that happened to <code>FTP.1</code>, percentage of female teachers in ISCED 1, for country with code 4180 for data year 2014. Here we didn't need an  <code>EDU_METER_AID</code> table sine indicators are referenced directly by their alphanumeric code, which do not have an equivalent numerical representation like in raw data.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7"><span class="section-number-3">1.7</span> A complete example</h3>
<div class="outline-text-3" id="text-1-7">
</div><div id="outline-container-sec-1-7-1" class="outline-4">
<h4 id="sec-1-7-1"><span class="section-number-4">1.7.1</span> Inserting the original questionnaire</h4>
<div class="outline-text-4" id="text-1-7-1">
<p>
To give an example consider inserting a made-up questionnaire say for Laos for year 2015 that
is saved in a file <code>Desktop/Example/LAOS-2015-Regional_Survey.xlsx</code>, as seen in
Figure <a href="#fig:laosDesktop">3</a>. First start the <code>RM_GUI.py</code> select the file
and click the adjacent <code>Validate</code>, the Status panel frame now shows:
</p>


<div id="fig:laosDesktop" class="figure">
<p><img src="./img/LAOS_desktop.png" alt="LAOS_desktop.png" />
</p>
<p><span class="figure-number">Figure 3:</span> Laos original questionnaire submission.</p>
</div>

<pre class="example">
----------Date: January 22, 2016----------
VALIDATION STEP

Original questionnaire submitted with path:
C:/Users/Mohamad/Desktop/Example/LAOS-2015-Regional_Survey.xlsx

Number of administrative divisions: 5.0
ADM1 name provided: District
Administrative divisions:
                  myDistrict 1
                  myDistrict 2
                  myDistrict 3
                  myDistrict 4
                  myDistrict 5

Reference year: 2015
Country name is filled: Lao People's Democratic Republic
The correct number of sheets(11)has been submitted.
Warning: The questionnaire contains missing values.

----------Questionnaire Validation finished.----------.

Validation successful, see report in:
Log/Lao People's Democratic Republic_16-01-22-13-32_validation.txt
</pre>

<p>
Since the checkbox <code>Open validation report</code> is ticked a validation report
should open and shows more or less similarly output to the one in the Status panel.
</p>

<p>
To insert the questionnaire, click on <code>Insert</code>. The Status panel should show:
</p>

<pre class="example">
INSERTION STEP

Inserting C:/Users/Mohamad/Desktop/Example/LAOS-2015-Regional_Survey.xlsx
Checking that region values add to the country value...Test passed.
Checking that parts are less than the totals...Test passed.
Checking sums of columns...
----------Questionnaire Insertion finished.----------.

Data report written to: 
 Log/Lao People's Democratic Republic_16-01-22-13-35_data_report.csv
</pre>

<p>
Moreover, since the checkbox <code>Open data report</code> is ticked, the data
report should open up. For this example, the data report looks like Figure <a href="#fig:laosDataReport">4</a>
</p>


<div id="fig:laosDataReport" class="figure">
<p><img src="./img/data_report.png" alt="data_report.png" />
</p>
<p><span class="figure-number">Figure 4:</span> Laos data report after insertion</p>
</div>

<p>
This implies the import is successfully, and these are the created
files:
</p>
<ul class="org-ul">
<li><b>backup file</b>: <code>RMS\Import\RM_Lao People's Democratic Republic_2015_16-01-22-13-38.xlsx</code>,
</li>
<li><b>validation report</b>: <code>RMS\Log\Lao People's Democratic Republic_16-01-22-13-38_validation.txt</code>,
</li>
<li><b>data report</b>: <code>RMS\Log\Lao People's Democratic
   Republic_16-01-22-13-38_data_report.csv</code>.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-7-2" class="outline-4">
<h4 id="sec-1-7-2"><span class="section-number-4">1.7.2</span> Moving to and exporting from the Observed series.</h4>
<div class="outline-text-4" id="text-1-7-2">
<p>
After successfully inserting an original questionnaire, one is advised to move the data from
<i>Reported</i> to <i>Observed</i> series. Notice that Laos now appears in the <code>Country</code> drop-down
list. Select Laos and the corresponding year, then
click on <code>REP to OBS</code> button. The Status panel should show 
</p>

<pre class="example">
Moving data for 4180-2015
Moved METER, INCLU and FTN tables from REP to OBS
Moved COMMENT_TABLE table from REP to OBS
Done.
</pre>

<p>
The <code>METER</code> table is where the data is, <code>INCLU</code> table is where the inclusion codes are saved, and <code>FTN</code> is where the cell comments are saved. Finally, <code>COMMENT_TABLE</code> is where the table comments are saved. 
</p>

<p>
Now, let's export <code>Teachers ISCED 2</code> worksheet for cleaning. Select the country,
year and series from the drop-down lists and from the <code>Sheet</code>
drop-down list select <code>Teachers ISCED 2</code>. Before clicking on the
adjacent <code>Export</code> button, select the <code>output folder</code> to be your
<code>Desktop</code>. 
</p>

<p>
The Status panel will have the confirmation seen in box
<a href="#src:export_clean">1</a>, and the Excel workbook should look like Figure <a href="#fig:export_clean">5</a>. Notice
the configurations panel in the top left corner, where the mode is <code>Edit</code> and the series is <code>OBS</code>. 
</p>

<pre class="example" id="src:export_clean">
Exporting Teachers ISCED 2 from OBS series for 
Lao People's Democratic Republic-2015....
File C:/Users/myUser/Desktop/Example/
Lao People's Democratic Republic_2015_Teachers ISCED 2_OBS.xlsx is created..
Done.
</pre>


<div id="fig:export_clean" class="figure">
<p><img src="./img/export_clean.png" alt="export_clean.png" />
</p>
<p><span class="figure-number">Figure 5:</span> Exported Laos data from observed series.</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-7-3" class="outline-4">
<h4 id="sec-1-7-3"><span class="section-number-4">1.7.3</span> Cleaning and reinserting</h4>
<div class="outline-text-4" id="text-1-7-3">
<p>
As mentioned before as long as the configuration panel is left
untouched and all tables are not moved, one can go ahead and change
the data, inclusion codes and insert cell and table comments. For
example, assume for some reason, for Laos-2015 data, we prefer to only
report the data under <code>T.2.GPV.Pu</code> in
column 3  and not to report <code>T.2.GPV.Pu.F</code> in column 4. We do this by using
inclusion code <code>X[:3]</code> to indicate that the current column is included in column 3.
</p>

<p>
Also we add a comment that the data is aggregated by programme team. Moreover, we add a table comment in cell H11, saying that some data is not trusted. See Figure <a href="#fig:laos_mod">6</a> and compare it to Figure <a href="#fig:export_clean">5</a>. Save and close the file.
</p>


<div id="fig:laos_mod" class="figure">
<p><img src="./img/laos_mod.png" alt="laos_mod.png" />
</p>
<p><span class="figure-number">Figure 6:</span> Modified Laos data from observed series.</p>
</div>

<p>
<b>To validate and insert</b> follow similar step as in Section <a href="#sec-1-2">1.2</a>. Start the <code>RM_GUI</code> select the modified file,
 validate and insert it. If successful the Status panel should show
</p>

<pre class="example">
----------Date: January 22, 2016----------
VALIDATION STEP

Edited questionnaire submitted with path:
C:/Users/Mohamad/Desktop/Example
/Lao People's Democratic Republic_2015_Teachers ISCED 2_OBS.xlsx

Number of administrative divisions: 5.0
Configuration section of edited questionnaire is properly filled
Warning: The questionnaire contains missing values.

----------Questionnaire Validation finished.----------.

Validation successful, see report in:
Log/Lao People's Democratic Republic_16-01-22-21-23_validation.txt
----------Date: January 22, 2016----------
INSERTION STEP

Inserting C:/Users/Mohamad/Desktop/Example/
        Lao People's Democratic Republic_2015_Teachers ISCED 2_OBS.xlsx
Checking that region values add to the country value...Test passed.
Checking that parts are less than the totals...Test passed.
Checking sums of columns...Test passed.
----------Questionnaire Insertion finished.----------.

Data report written to: 
 Log/Lao People's Democratic Republic_16-01-22-21-23_data_report.csv
</pre>

<p>
otherwise it would list validation errors such as.
</p>

<pre class="example">
----------Date: January 22, 2016----------
VALIDATION STEP

Edited questionnaire submitted with path:
C:/Users/Mohamad/Desktop/Example
/Lao People's Democratic Republic_2015_Teachers ISCED 2_OBS.xlsx

Number of administrative divisions: 5.0
Configuration section of edited questionnaire is properly filled
Error: Column 3 in table Table 2.1 has improper values.
Warning: The questionnaire contains missing values.

----------Questionnaire Validation finished.----------.

Pre-processing validation failed. Some errors exist see log file in:
Log/Lao People's Democratic Republic_16-01-22-21-25_validation.txt
</pre>

<p>
Since inserting is successful, again, the following files are created:
</p>
<ul class="org-ul">
<li><b>backup file</b>: <code>RMS\Import\RM_Lao People's Democratic Republic_2015_16-01-22-21-23.xlsx</code>,
</li>
<li><b>validation report</b>: <code>RMS\Log\Lao People's Democratic Republic_16-01-22-21-23_validation.txt</code>,
</li>
<li><b>data report</b>: <code>RMS\Log\Lao People's Democratic Republic_16-01-22-21-23_data_report.csv</code>.
</li>
</ul>

<p>
Now if you reexport the whole questionnaire, <code>Teachers ISCED 2</code>
sheet, or only <code>Table 2.1</code> from the observed series, you should be
able to see the changes and comments made earlier.
</p>
</div>
</div>

<div id="outline-container-sec-1-7-4" class="outline-4">
<h4 id="sec-1-7-4"><span class="section-number-4">1.7.4</span> Calculating indicators</h4>
<div class="outline-text-4" id="text-1-7-4">
<p>
To calculate indicators, first select the country name and year, then select the <code>EST</code> series. If the data is not yet in the <code>EST</code> series, move it by clicking on the button <code>OBS to EST</code>, maybe also <code>REP to OBS</code> if you haven't moved it yet to <code>OBS</code> series. Then click on the button <code>Calculate</code>.  In around <b>30 seconds to a minute</b>, the Status panel should indicated that the process is successful.
</p>

<pre class="example">
Successful..all indicators are calculated.
</pre>

<p>
Now using the wildcards, lets extract the percentage of teachers with attainment of ISCED 5 and higher for all public institutions, one way of doing this is by typing <code>EA5pPT.%Pu</code> and clicking on the adjacent <code>Extract</code>. The file is now saved under the name <code>Lao People's Democratic Republic_2015_INDIC_EA5pPT.xxPu.xlsx</code> in the <code>Export</code> folder if no other folder is specified. This is indicated in the Status panel as seen below. 
</p>

<pre class="example">
Extracting EA5pPT.%Pu for Lao People's Democratic Republic-2015....
File /home/mo/Desktop/Lao People's Democratic Republic_2015_INDIC_EA5pPT.xxPu.xlsx is created..
Done.
</pre>

<p>
The file should also automatically open up and in this example it looks like this.
</p>


<div class="figure">
<p><img src="./img/export_indicator.png" alt="export_indicator.png" />
</p>
<p><span class="figure-number">Figure 7:</span> Screen shot of EA5pPT indicator</p>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Indicators</h2>
<div class="outline-text-2" id="text-2">
<p>
This section describes how indicators are computed and what are the
AC codes involved in their computation.  For each indicator, we give
a table with four columns. The first column has the ISCED level. The
second one has the indicator alphanumeric code (IND_ID). The third
column has the formula used to compute this indicator. The fourth
column contains yes or no depending on whether the indicator for the
highest and lowest among administrative divisions is also
calculated.
</p>

<p>
Technical notations used across this section: 
</p>
<ul class="org-ul">
<li>The <code>Python method</code> lists the name of function in the <code>Libraries/rmindicators.py</code> script that calculates that indicator.
</li>
<li>The superscript <code>L</code> means that the value from the previous year is being taken. For example, if the emco year is 2015 T.1<sup>L</sup> means the 2014 value of T.1.
</li>
<li>Some indicators correspond to the highest and lowest value among
all the regions of some indicator; A.Max and A.Min correspond to the
highest and lowest value, respectively, among all the regions for
the AC code A.
</li>
</ul>

<p>
Some more specific technical notation exists for some of the subsections.
</p>
</div>
<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Percentage of female teachers</h3>
<div class="outline-text-3" id="text-2-1">
<dl class="org-dl">
<dt> Python method </dt><dd>teachers_percentage_female
</dd>
<dt> IND_IDS information </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">FTP.1</td>
<td class="left">T.1.F/T.1</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">FTP.2.GPV</td>
<td class="left">T.2.GPV.F/T.2.GPV</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">FTP.3.GPV</td>
<td class="left">T.3.GPV.F/T.3.GPV</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">FTP.2t3.GPV</td>
<td class="left">T.2t3.GPV.F/T.2t3.GPV</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>

<p>
In this same method, there is the computation of female
teachers percentage in public and private institutions. Their
respective tables are the following:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">FTP.1.Pu</td>
<td class="left">T.1.Pu.F/T.1.Pu</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">FTP.2.GPV.Pu</td>
<td class="left">T.2.GPV.Pu.F/T.2.GPV.Pu</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">FTP.3.GPV.Pu</td>
<td class="left">T.3.GPV.Pu.F/T.3.GPV.Pu</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">FTP.2t3.GPV.Pu</td>
<td class="left">T.2t3.GPV.Pu.F/T.2t3.GPV.Pu</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">FTP.1.Pr</td>
<td class="left">T.1.Pr.F/T.1.Pr</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">FTP.2.GPV.Pr</td>
<td class="left">T.2.GPV.Pr.F/T.2.GPV.Pr</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">FTP.3.GPV.Pr</td>
<td class="left">T.3.GPV.Pr.F/T.3.GPV.Pr</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">FTP.2t3.GPV.Pr</td>
<td class="left">T.2t3.GPV.Pr.F/T.2t3.GPV.Pr</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> Percentage of newly recruited teachers</h3>
<div class="outline-text-3" id="text-2-2">
<dl class="org-dl">
<dt> Python method </dt><dd>newly_recruited_teachers
</dd>
<dt> IND_IDS information </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">NTP.1</td>
<td class="left">NT.1/T.1</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">NTP.2.GPV</td>
<td class="left">NT.2.GPV/T.2.GPV</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">NTP.3.GPV</td>
<td class="left">NT.3.GPV/T.3.GPV</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">NTP.2t3.GPV</td>
<td class="left">NT.2t3.GPV/T.2t3.GPV</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>

<p>
In this same method, there is the computation of newly
recruited teachers percentage in public and private
institutions. Their respective tables are the following:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">NTP.1.Pu</td>
<td class="left">NT.1.Pu/T.1.Pu</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">NTP.2.GPV.Pu</td>
<td class="left">NT.2.GPV.Pu/T.2.GPV.Pu</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">NTP.3.GPV.Pu</td>
<td class="left">NT.3.GPV.Pu/T.3.GPV.Pu</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">NTP.2t3.GPV.Pu</td>
<td class="left">NT.2t3.GPV.Pu/T.2t3.GPV.Pu</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">NTP.1.Pr</td>
<td class="left">NT.1.Pr/T.1.Pr</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">NTP.2.GPV.Pr</td>
<td class="left">NT.2.GPV.Pr/T.2.GPV.Pr</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">NTP.3.GPV.Pr</td>
<td class="left">NT.3.GPV.Pr/T.3.GPV.Pr</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">NTP.2t3.GPV.Pr</td>
<td class="left">NT.2t3.GPV.Pr/T.2t3.GPV.Pr</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>
</div>
</div>


<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> Pupils teachers ratio</h3>
<div class="outline-text-3" id="text-2-3">
<dl class="org-dl">
<dt> Python method </dt><dd>pupils_teachers_ratio
</dd>
<dt> IND_IDS information </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">PTRHC.1</td>
<td class="left">E.1/T.1</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">PTRHC.2.GPV</td>
<td class="left">E.2.GPV/T.2.GPV</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">PTRHC.3.GPV</td>
<td class="left">E.3.GPV/T.3.GPV</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">PTRHC.2t3.GPV</td>
<td class="left">(E.2.GPV+E.3.GPV)/T.2t3.GPV</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>
<p>
In this same method, there is the computation of newly
recruited teachers percentage in public and private
institutions. Their respective tables are the following:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">PTRHC.1.Pu</td>
<td class="left">E.1.Pu/T.1.Pu</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">PTRHC.2.GPV.Pu</td>
<td class="left">E.2.GPV.Pu/T.2.GPV.Pu</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">PTRHC.3.GPV.Pu</td>
<td class="left">E.3.GPV.Pu/T.3.GPV.Pu</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">PTRHC.2t3.GPV.Pu</td>
<td class="left">(E.2.GPV.Pu+E.3.GPV.Pu)/T.2t3.GPV.Pu</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">PTRHC.1.Pr</td>
<td class="left">E.1.Pr/T.1.Pr</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">PTRHC.2.GPV.Pr</td>
<td class="left">E.2.GPV.Pr/T.2.GPV.Pr</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">PTRHC.3.GPV.Pr</td>
<td class="left">E.3.GPV.Pr/T.3.GPV.Pr</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">PTRHC.2t3.GPV.Pr</td>
<td class="left">(E.2.GPV.Pr + E.2.GPV.Pr)/T.2t3.GPV.Pr</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4"><span class="section-number-3">2.4</span> Percentage of trained teachers</h3>
<div class="outline-text-3" id="text-2-4">
<dl class="org-dl">
<dt> Python method </dt><dd>percentage_trained_teachers
</dd>
<dt> IND_IDS information </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">TRTP.1</td>
<td class="left">T.1.trained/T.1</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">TRTP.2.GPV</td>
<td class="left">T.2.GPV.trained/T.2.GPV</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">TRTP.3.GPV</td>
<td class="left">T.3.GPV.trained/T.3.GPV</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">TRTP.2t3.GPV</td>
<td class="left">T.2t3.GPV.trained/T.2t3.GPV</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>
<p>
In this same method, there is the computation of the percentage of
trained newly recruited teachers.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">TrNTP.1</td>
<td class="left">NT.1.trained/NT.1</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">TrNTP.2.GPV</td>
<td class="left">NT.2.GPV.trained/NT.2.GPV</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">TrNTP.3.GPV</td>
<td class="left">NT.3.GPV.trained/NT.3.GPV</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">TrNTP.2t3.GPV</td>
<td class="left">NT.2t3.GPV.trained/NT.2t3.GPV</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>
<p>
Finally, for the previous indicators this method also computes the
previous indicators for public and private institutions. Their
corresponding tables are the following:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">TRTP.1.Pu</td>
<td class="left">T.1.Pu.trained/T.1.Pu</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">TRTP.2.GPV.Pu</td>
<td class="left">T.2.GPV.Pu.trained/T.2.GPV.Pu</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">TRTP.3.GPV.Pu</td>
<td class="left">T.3.GPV.Pu.trained/T.3.GPV.Pu</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">TRTP.2t3.GPV.Pu</td>
<td class="left">T.2t3.GPV.Pu.trained/T.2t3.GPV.Pu</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">TRTP.1.Pr</td>
<td class="left">T.1.Pr.trained/T.1.Pr</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">TRTP.2.GPV.Pr</td>
<td class="left">T.2.GPV.Pr.trained/T.2.GPV.Pr</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">TRTP.3.GPV.Pr</td>
<td class="left">T.3.GPV.Pr.trained/T.3.GPV.Pr</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">TRTP.2t3.GPV.Pr</td>
<td class="left">T.2t3.GPV.Pr.trained/T.2t3.GPV.Pr</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">TrNTP.1.Pu</td>
<td class="left">NT.1.Pu.trained/NT.1.Pu</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">TrNTP.2.GPV.Pu</td>
<td class="left">NT.2.GPV.Pu.trained/NT.2.GPV.Pu</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">TrNTP.3.GPV.Pu</td>
<td class="left">NT.3.GPV.Pu.trained/NT.3.GPV.Pu</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">TrNTP.2t3.GPV.Pu</td>
<td class="left">NT.2t3.GPV.Pu.trained/NT.2t3.GPV.Pu</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">TrNTP.1.Pr</td>
<td class="left">NT.1.Pr.trained/NT.1.Pr</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">TrNTP.2.GPV.Pr</td>
<td class="left">NT.2.GPV.Pr.trained/NT.2.GPV.Pr</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">TrNTP.3.GPV.Pr</td>
<td class="left">NT.3.GPV.Pr.trained/NT.3.GPV.Pr</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">TrNTP.2t3.GPV.Pr</td>
<td class="left">NT.2t3.GPV.Pr.trained/NT.2t3.GPV.Pr</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>
</div>
</div>



<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5"><span class="section-number-3">2.5</span> Percentage of private teachers</h3>
<div class="outline-text-3" id="text-2-5">
<dl class="org-dl">
<dt> Python method </dt><dd>percentage_private_teachers
</dd>
<dt> IND_IDS information </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">PrTP.1</td>
<td class="left">T.1.Pr/T.1</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">PrTP.2.GPV</td>
<td class="left">T.2.GPV.Pr/T.2.GPV</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">PrTP.3.GPV</td>
<td class="left">T.3.GPV.Pr/T.3.GPV</td>
<td class="left">yes</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">PrTP.2t3.GPV</td>
<td class="left">T.2t3.GPV.Pr/T.2t3.GPV</td>
<td class="left">yes</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-2-6" class="outline-3">
<h3 id="sec-2-6"><span class="section-number-3">2.6</span> Percentage of non-permanent teachers</h3>
<div class="outline-text-3" id="text-2-6">
<p>
This has three sets of symbols. One for the private sector, one
for the public sector and one combined.
</p>
<dl class="org-dl">
<dt> Python method </dt><dd>percentage_non_permanent_teachers
</dd>
<dt> IND_IDS information Private </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">FixTP.1.Pr</td>
<td class="left">T.1.Pr.Fix/T.1.Pr</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">FixTP.2.GPV.Pr</td>
<td class="left">T.2.GPV.Pr.Fix/T.2.GPV.Pr</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">FixTP.3.GPV.Pr</td>
<td class="left">T.3.GPV.Pr.Fix/T.3.GPV.Pr</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">FixTP.2t3.GPV.Pr</td>
<td class="left">T.2t3.GPV.Pr.Fix/T.2t3.GPV.Pr</td>
<td class="left">no</td>
</tr>
</tbody>
</table>

<dl class="org-dl">
<dt> IND_IDS information Public </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">FixTP.1.Pu</td>
<td class="left">T.1.Pu.Fix/T.1.Pu</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">FixTP.2.GPV.Pu</td>
<td class="left">T.2.GPV.Pu.Fix/T.2.GPV.Pu</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">FixTP.3.GPV.Pu</td>
<td class="left">T.3.GPV.Pu.Fix/T.3.GPV.Pu</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">FixTP.2t3.GPV.Pu</td>
<td class="left">T.2t3.GPV.Pu.Fix/T.2t3.GPV.Pu</td>
<td class="left">no</td>
</tr>
</tbody>
</table>

<dl class="org-dl">
<dt> IND_IDS information Combined </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">FixTP.1</td>
<td class="left">(T.1.Pr.Fix+T.1.Pu.Fix)/(T.1.Pr+T.1.Pu)</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">FixTP.2.GPV</td>
<td class="left">(T.2.GPV.Pr.Fix+T.2.GPV.Pu.Fix)/(T.2.GPV.Pr+T.2.GPV.Pu)</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">FixTP.3.GPV</td>
<td class="left">(T.3.GPV.Pu.Fix+T.3.GPV.Pr.Fix)/(T.3.GPV.Pr+T.3.GPV.Pu)</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">FixTP.2t3.GPV</td>
<td class="left">(T.2t3.GPV.Pu.Fix+T.2t3.GPV.Pr.Fix)/(T.2t3.GPV.Pr+T.2t3.GPV.Pu)</td>
<td class="left">no</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-2-7" class="outline-3">
<h3 id="sec-2-7"><span class="section-number-3">2.7</span> Percentage of permanent teachers</h3>
<div class="outline-text-3" id="text-2-7">
<p>
This has three sets of symbols. One for the private sector, one
for the public sector and one combined.
</p>
<dl class="org-dl">
<dt> Python method </dt><dd>percentage_non_permanent_teachers
</dd>
<dt> IND_IDS information Private </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">PermTP.1.Pr</td>
<td class="left">T.1.Pr.Perm/T.1.Pr</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">PermTP.2.GPV.Pr</td>
<td class="left">T.2.GPV.Pr.Perm/T.2.GPV.Pr</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">PermTP.3.GPV.Pr</td>
<td class="left">T.3.GPV.Pr.Perm/T.3.GPV.Pr</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">PermTP.2t3.GPV.Pr</td>
<td class="left">T.2t3.GPV.Pr.Perm/T.2t3.GPV.Pr</td>
<td class="left">no</td>
</tr>
</tbody>
</table>

<dl class="org-dl">
<dt> IND_IDS information Public </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">PermTP.1.Pu</td>
<td class="left">T.1.Pu.Perm/T.1.Pu</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">PermTP.2.GPV.Pu</td>
<td class="left">T.2.GPV.Pu.Perm/T.2.GPV.Pu</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">PermTP.3.GPV.Pu</td>
<td class="left">T.3.GPV.Pu.Perm/T.3.GPV.Pu</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">PermTP.2t3.GPV.Pu</td>
<td class="left">T.2t3.GPV.Pu.Perm/T.2t3.GPV.Pu</td>
<td class="left">no</td>
</tr>
</tbody>
</table>

<dl class="org-dl">
<dt> IND_IDS information Combined </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">PermTP.1</td>
<td class="left">(T.1.Pr.Perm+T.1.Pu.Perm)/(T.1.Pr+T.1.Pu)</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">PermTP.2.GPV</td>
<td class="left">(T.2.GPV.Pr.Perm+T.2.GPV.Pu.Perm)/(T.2.GPV.Pr+T.2.GPV.Pu)</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">PermTP.3.GPV</td>
<td class="left">(T.3.GPV.Pu.Perm+T.3.GPV.Pr.Perm)/(T.3.GPV.Pr+T.3.GPV.Pu)</td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">PermTP.2t3.GPV</td>
<td class="left">(T.2t3.GPV.Pu.Perm+T.2t3.GPV.Pr.Perm)/(T.2t3.GPV.Pr+T.2t3.GPV.Pu)</td>
<td class="left">no</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-2-8" class="outline-3">
<h3 id="sec-2-8"><span class="section-number-3">2.8</span> Attrition rate</h3>
<div class="outline-text-3" id="text-2-8">
<dl class="org-dl">
<dt> Python method </dt><dd>percentage_non_permanent_teachers
</dd>
<dt> IND_IDS information Private </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">TAttrR.1</td>
<td class="left">100*(T.1<sup>L</sup> + NT.1 - T.1)/T.1<sup>L</sup></td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">TAttrR.2.GPV</td>
<td class="left">100*(T.2.GPV<sup>L</sup> + NT.2.GPV - T.2.GPV)/T.2.GPV<sup>L</sup></td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">TAttrR.3.GPV</td>
<td class="left">100*(T.3.GPV<sup>L</sup> + NT.3.GPV - T.3.GPV)/T.3.GPV<sup>L</sup></td>
<td class="left">no</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">TAttrR.2t3.GPV</td>
<td class="left">100*(T.2t3.GPV<sup>L</sup> + NT.2t3.GPV - T.2t3.GPV)/T.2t3.GPV<sup>L</sup></td>
<td class="left">no</td>
</tr>
</tbody>
</table>
<p>
When using a previous year data, as T.1<sup>L</sup>, if the data is available it is used, otherwise we use the <code>.m1</code> extension as  <code>T.1m1</code>, which is collected from this years questionnaire.
</p>
</div>
</div>

<div id="outline-container-sec-2-9" class="outline-3">
<h3 id="sec-2-9"><span class="section-number-3">2.9</span> Mean age</h3>
<div class="outline-text-3" id="text-2-9">
<dl class="org-dl">
<dt> Python method </dt><dd>mean_age_level(level in ['T.1', 'T.2.GPV', 'T.3.GPV', 'T.2t3.GPV'])
</dd>
<dt> IND_IDS information </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">MAge.T.1</td>
<td class="left">&sum;<sub>y in cat</sub> T.1.y &times; MP.y / &sum;<sub>y in cat</sub> T.1.y</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">MAge.T.2.GPV</td>
<td class="left">&sum;<sub>y in cat</sub> T.2.GPV.y &times; MP.y/ &sum;<sub>y in cat</sub> T.2.GPV.y</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">MAge.T.3.GPV</td>
<td class="left">&sum;<sub>y in cat</sub> T.3.GPV.y &times; MP.y/&sum;<sub>y in cat</sub> T.3.GPV.y</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">MAge.T.2t3.GPV</td>
<td class="left">&sum;<sub>y in cat</sub> T.2t3.GPV.y&times; MP.y/ &sum;<sub>y in cat</sub> T.2t3.GPV.y</td>
<td class="left">No</td>
</tr>
</tbody>
</table>
<p>
where <code>cat</code> is <code>Ag20m</code>, <code>Ag20t29</code>, <code>Ag30t39</code>, <code>Ag40t49</code>, <code>Ag50t59</code> and <code>Ag60p</code>. Midpoints (MP) are based on the following:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Age in years</th>
<th scope="col" class="right">&lt;20</th>
<th scope="col" class="right">20-29</th>
<th scope="col" class="right">30-39</th>
<th scope="col" class="right">40-49</th>
<th scope="col" class="right">50-59</th>
<th scope="col" class="right">60+</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">Midpoints</td>
<td class="right">20</td>
<td class="right">24.5</td>
<td class="right">34.5</td>
<td class="right">44.5</td>
<td class="right">54.5</td>
<td class="right">60</td>
</tr>
</tbody>
</table>
<p>
Note that all indicators are calculated for Total, Public and Private levels.
</p>
</div>
</div>

<div id="outline-container-sec-2-10" class="outline-3">
<h3 id="sec-2-10"><span class="section-number-3">2.10</span> Mean years of experience</h3>
<div class="outline-text-3" id="text-2-10">
<dl class="org-dl">
<dt> Python method </dt><dd>mean_exp_level(level in ['T.1', 'T.2.GPV', 'T.3.GPV', 'T.2t3.GPV'])
</dd>
<dt> IND_IDS information </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">ISCED 1</td>
<td class="left">MExp.T.1</td>
<td class="left">&sum;<sub>y in cat</sub> T.1.y &times; &times; MP.y/ &sum;<sub>y in cat</sub> T.1.y</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">ISCED 2</td>
<td class="left">MExp.T.2.GPV</td>
<td class="left">&sum;<sub>y in cat</sub> T.2.GPV.y&times; MP.y / &sum;<sub>y in cat</sub> T.2.GPV.y</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">ISCED 3</td>
<td class="left">MExp.T.3.GPV</td>
<td class="left">&sum;<sub>y in cat</sub> T.3.GPV.y&times; MP.y / &sum;<sub>y in cat</sub> T.3.GPV.y</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">ISCED 23</td>
<td class="left">MExp.T.2t3.GPV</td>
<td class="left">&sum;<sub>y in cat</sub> T.2t3.GPV.y&times; MP.y / &sum;<sub>y in cat</sub> T.2t3.GPV.y</td>
<td class="left">No</td>
</tr>
</tbody>
</table>
<p>
where <code>cat</code> is  <code>Exp1t2</code>,  <code>Exp3t5</code>, <code>Exp6t10</code>,  <code>Exp11t15</code> and  <code>Exp15p</code>.  and Midpoints (MP) are based on the following:  
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Experience in years</th>
<th scope="col" class="right">New</th>
<th scope="col" class="right">1-2</th>
<th scope="col" class="right">3-5</th>
<th scope="col" class="right">6-10</th>
<th scope="col" class="right">11-15</th>
<th scope="col" class="right">15+</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">Midpoints</td>
<td class="right">0.5</td>
<td class="right">1.5</td>
<td class="right">4</td>
<td class="right">8</td>
<td class="right">13</td>
<td class="right">17</td>
</tr>
</tbody>
</table>
<p>
Note that all indicators are calculated for Total, Public and Private levels.
</p>
</div>
</div>

<div id="outline-container-sec-2-11" class="outline-3">
<h3 id="sec-2-11"><span class="section-number-3">2.11</span> Highest level of educational attainment</h3>
<div class="outline-text-3" id="text-2-11">
<dl class="org-dl">
<dt> Python method </dt><dd>percentage_teachers_attainment
</dd>
<dt> IND_IDS information </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Highest educational attainment</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">Lower secondary or Less</td>
<td class="left">EA2mPT.IS</td>
<td class="left">T.IS.EA.2m / T.IS</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">Upper secondary</td>
<td class="left">EA3PT.IS</td>
<td class="left">T.IS.EA.3 / T.IS</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">Post secondary</td>
<td class="left">EA4PT.IS</td>
<td class="left">T.IS.EA.4 / T.IS</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">At least tertiary</td>
<td class="left">EA5pPT.IS</td>
<td class="left">(T.IS.EA.5 + T.IS.EA.6+T.IS.EA.7+T.IS.EA.8)/T.IS</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">Unknown</td>
<td class="left">EAukPT.IS</td>
<td class="left">T.IS.EA.uk / T.IS</td>
<td class="left">No</td>
</tr>
</tbody>
</table>
<p>
<code>IS</code> stands for ISCED level which are <code>[1, 2.GPV, 3.GPV, 2t3.GPV]</code>, combined with suffixes <code>['.Pu', '.Pr']</code> for public and private sub-category.
</p>


<p>
Note that all indicators are calculated for Total, Public and Private levels.    
</p>
</div>
</div>

<div id="outline-container-sec-2-12" class="outline-3">
<h3 id="sec-2-12"><span class="section-number-3">2.12</span> Percentage of teachers by years of experience</h3>
<div class="outline-text-3" id="text-2-12">
<dl class="org-dl">
<dt> Python method </dt><dd>percentage_teachers_exp
</dd>
<dt> IND_IDS information </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Experience</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">1 to 2 years</td>
<td class="left">Exp1t2PT.ISCED</td>
<td class="left">T.ISCED.Exp1t2/T.ISCED</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">3 to 5 years</td>
<td class="left">Exp3t5PT.ISCED</td>
<td class="left">T.ISCED.Exp3t5/T.ISCED</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">5 to 10 years</td>
<td class="left">Exp6t10PT.ISCED</td>
<td class="left">T.ISCED.Exp6t10/T.ISCED</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">11 to 15 years</td>
<td class="left">Exp11t15PT.ISCED</td>
<td class="left">T.ISCED.Exp11t15/T.ISCED</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">more 15 than years</td>
<td class="left">Exp15pPT.ISCED</td>
<td class="left">T.ISCED.Exp15p/T.ISCED</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">Unknown</td>
<td class="left">ExpukPT.ISCED</td>
<td class="left">T.ISCED.Expuk/T.ISCED</td>
<td class="left">No</td>
</tr>
</tbody>
</table>
<p>
<code>ISCED</code> is <code>['  1', '2.GPV', '3.GPV', '2t3.GPV']</code>, combined with suffixes <code>['.Pu', '.Pr']</code> for public and private sub-category.
</p>

<p>
Note that all indicators are calculated for Total, Public and Private levels.    
</p>
</div>
</div>

<div id="outline-container-sec-2-13" class="outline-3">
<h3 id="sec-2-13"><span class="section-number-3">2.13</span> Percentage of teachers by age</h3>
<div class="outline-text-3" id="text-2-13">
<dl class="org-dl">
<dt> Python method </dt><dd>percentage_teachers_age
</dd>
<dt> IND_IDS information </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Age</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
<th scope="col" class="left">H &amp; L</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">Less than 20 years</td>
<td class="left">Ag20mPT.ISCED</td>
<td class="left">T.ISCED.Ag20m/T.ISCED</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">20 to 29 years</td>
<td class="left">Ag20t29PT.ISCED</td>
<td class="left">T.ISCED.Ag29t29/T.ISCED</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">30 to 39 years</td>
<td class="left">Ag30t39PT.ISCED</td>
<td class="left">T.ISCED.Ag39t39/T.ISCED</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">40 to 49 years</td>
<td class="left">Ag40t49PT.ISCED</td>
<td class="left">T.ISCED.Ag49t49/T.ISCED</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">50 to 59 years</td>
<td class="left">Ag50t59PT.ISCED</td>
<td class="left">T.ISCED.Ag59t59/T.ISCED</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">60 years or more</td>
<td class="left">Ag60pPT.ISCED</td>
<td class="left">T.ISCED.Ag60P/T.ISCED</td>
<td class="left">No</td>
</tr>

<tr>
<td class="left">Unknown</td>
<td class="left">AgukPT.ISCED</td>
<td class="left">T.ISCED.Aguk/T.ISCED</td>
<td class="left">No</td>
</tr>
</tbody>
</table>
<p>
<code>ISCED</code> is <code>['  1', '2.GPV', '3.GPV', '2t3.GPV']</code>, combined with suffixes <code>['.Pu', '.Pr']</code> for public and private sub-category.
</p>

<p>
Note that all indicators are calculated for Total, Public and Private levels.    
</p>
</div>
</div>

<div id="outline-container-sec-2-14" class="outline-3">
<h3 id="sec-2-14"><span class="section-number-3">2.14</span> Dissimilarity index</h3>
<div class="outline-text-3" id="text-2-14">
<dl class="org-dl">
<dt> Python method </dt><dd>dissimilarity_index
</dd>
<dt> IND_IDS information </dt><dd></dd>
</dl>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Measures of inequality in the</th>
<th scope="col" class="left">IND_ID</th>
<th scope="col" class="left">FORMULA</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">All</td>
<td class="left">DIndT.IS</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{T.IS_a}{T.IS} - \frac{E.IS_a}{E.IS} \mid\)</td>
</tr>

<tr>
<td class="left">Female</td>
<td class="left">DIndT.IS.F</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{T.IS.F_a}{T.IS.F} - \frac{E.IS_a}{E.IS} \mid\)</td>
</tr>

<tr>
<td class="left">Teachers aged 50 and above</td>
<td class="left">DIndT.IS.Ag50p</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{T.IS.Ag50p_a}{T.IS.Ag50p} - \frac{E.IS_a}{E.IS} \mid\)</td>
</tr>

<tr>
<td class="left">Newly recruited</td>
<td class="left">DIndNT.IS</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{NT.IS_a}{NT.IS} - \frac{E.IS_a}{E.IS} \mid\)</td>
</tr>

<tr>
<td class="left">Math</td>
<td class="left">DIndT.IS.Math</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{T.IS.Math_a}{T.IS.Math} - \frac{E.IS_a}{E.IS} \mid\)</td>
</tr>

<tr>
<td class="left">Reading and writing</td>
<td class="left">DIndT.IS.Read</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{T.IS.Read_a}{T.IS.Read} - \frac{E.IS_a}{E.IS} \mid\)</td>
</tr>

<tr>
<td class="left">Trained teachers</td>
<td class="left">DIndT.IS.trained</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{T.IS.trained_a}{T.IS.trained} - \frac{E.IS_a}{E.IS} \mid\)</td>
</tr>

<tr>
<td class="left">Newly recruited and trained teachers</td>
<td class="left">DIndNT.IS.trained</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{NT.IS.trained_a}{NT.IS.trained} - \frac{E.IS_a}{E.IS} \mid\)</td>
</tr>

<tr>
<td class="left">Teachers with ISCED level+1 or less</td>
<td class="left">DIndT.IS.EA.ISp1m</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{T.IS.EA.ISp1m_a}{T.IS.EA.ISp1m} - \frac{E.IS_a}{E.IS} \mid\)</td>
</tr>

<tr>
<td class="left">Teachers with ISCED level+2 or more</td>
<td class="left">DIndT.IS.EA.ISp2p</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{T.IS.EA.ISp2p_a}{T.IS.EA.ISp2p} - \frac{E.IS_a}{E.IS} \mid\)</td>
</tr>

<tr>
<td class="left">Teachers with less than 2 years of exp</td>
<td class="left">DIndT.IS.Exp2m</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{T.IS.Exp2m_a}{T.IS.Exp2m} - \frac{E.IS_a}{E.IS} \mid\)</td>
</tr>

<tr>
<td class="left">Teachers with more than 10 years of exp</td>
<td class="left">DIndT.IS.Exp10p</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{T.IS.Exp10p_a}{T.IS.Exp10p} - \frac{E.IS_a}{E.IS} \mid\)</td>
</tr>

<tr>
<td class="left">Private teachers</td>
<td class="left">DIndT.IS.Pr</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{T.IS.Pr_a}{T.IS.Pr} - \frac{E.IS_a}{E.IS} \mid\)</td>
</tr>

<tr>
<td class="left">Non-permanent teachers, total</td>
<td class="left">DIndT.IS.Fix</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{T.IS.Fix_a}{T.IS.Fix} - \frac{E.IS_a}{E.IS} \mid\)</td>
</tr>

<tr>
<td class="left">Non-permanent teachers, private</td>
<td class="left">DIndT.IS.Pr.Fix</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{T.IS.Pr.Fix_a}{T.IS.Pr.Fix} - \frac{E.IS.Pr_a}{E.IS.Pr} \mid\)</td>
</tr>

<tr>
<td class="left">Non-permanent teachers, public</td>
<td class="left">DIndT.IS.Pu.Fix</td>
<td class="left">\(\frac{1}{2} \sum_a\mid \frac{T.IS.Pu.Fix_a}{T.IS.Pu.Fix} - \frac{E.IS.Pu_a}{E.IS.Pu} \mid\)</td>
</tr>
</tbody>
</table>
<p>
Much notations are omitted for clearer presentation.
</p>
<ul class="org-ul">
<li><code>IS</code> stands for ISCED level which are <code>[1, 2.GPV, 3.GPV, 2t3.GPV]</code>.
</li>
<li><code>a</code> stands for administrative division, on the denominators the <code>a</code> is omitted for national level data.
</li>
<li><code>E.2t3.GPV</code> is not collected in the questionnaire, so it is <code>E.2.GPV + E.3.GPV</code>.
</li>
<li>To compute age 50 plus, data in ages 50 to 59 and 60 plus are added. This notation is omitted in the formula for brevity.
</li>
<li><code>Math</code>, <code>Reading and Writing</code> are only calculated for ISCED level 2t3, total.
</li>
<li><code>ISp1m</code> reads as ISCED level which is 1 level above or less than the actual level, that is for ISCED 2 <code>ISp1m = 3m</code>, and for ISCED 2t3 <code>ISp1m =4m</code>. The levels are summed.
</li>
<li><code>ISp2p</code> reads as ISCED level which is 2 level above or more than the actual level, that is for ISCED 2 <code>ISp2p = 4pm</code>, and for ISCED 2t3 <code>ISp2p =5p</code>. The levels are summed.
</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Adding  Indicators</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> The indicators class</h3>
<div class="outline-text-3" id="text-3-1">
<p>
To deal with indicator calculations, a Python class named
<code>indicators()</code> was created. It is in the script
<code>RMS/Libraries/rmindicators.py</code>. The class has three types of
methods, auxiliary, indicators and action methods.
</p>

<p>
The auxiliary methods are an aid either for the computation of
indicators or for SQL interaction. Examples of these methods
are: <code>get_nadm1</code>, <code>set_database_connection</code>, <code>get_country_code</code>,
<code>column_operation</code>, <code>compute_percentages</code>.
</p>

<p>
The indicator methods, are methods that compute a value of an
indicator and adds it to the SQL database. Examples of
these methods are: <code>pupils_teachers_ratio</code>, <code>newly_recruited_teachers</code>,
<code>teachers_percentage_female</code>, <code>percentage_trained_teachers</code>, and
<code>percentage_private_teachers</code>.
</p>

<p>
There are only two action methods: <code>__init__</code> and
<code>compute_all_indicators</code>. The former is the initializer of the
class and is called every time the class is initiated. The latter
is a method that calls all the other indicators methods.
</p>

<p>
Without dwelling into much details the objective of this section is
to show how to program new indicators by using the methods of the
<code>indicators</code> class.
</p>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Setup template</h3>
<div class="outline-text-3" id="text-3-2">
<p>
To program new indicators, we first need to create a method that
computes the values of the indicator and writes them to the
database. Second, we need to add this newly created method to
<code>compute_all_indicators</code>. At this point, the GUI will also compute
the indicator when the <code>Calculate</code> button is clicked. The following
is the current definition of <code>compute_all_indicators</code>, which shows
the list of indicators that are calculated every time this method
is called.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">compute_all_indicators</span>(<span style="color: #F92672;">self</span>):
        <span style="color: #E6DB74;">""" Execute functions to calculate indicators."""</span>
        <span style="color: #75715E;">### </span><span style="color: #75715E;">Moving data to Audit Temp</span>
        <span style="color: #F92672;">self</span>.audit_trail()

        <span style="color: #75715E;">##### </span><span style="color: #75715E;">Calculating indicators</span>
        <span style="color: #F92672;">self</span>.pupils_teachers_ratio()
        <span style="color: #F92672;">self</span>.newly_recruited_teachers()
        <span style="color: #F92672;">self</span>.teachers_percentage_female()
        <span style="color: #F92672;">self</span>.percentage_trained_teachers()
        <span style="color: #F92672;">self</span>.percentage_private_teachers()
        <span style="color: #F92672;">self</span>.attrition_rate()
        <span style="color: #F92672;">self</span>.percentage_non_permanent_teachers()
        <span style="color: #F92672;">self</span>.percentage_teachers_attainment()
        <span style="color: #F92672;">self</span>.percentage_teachers_exp()
        <span style="color: #F92672;">self</span>.percentage_teachers_age()
        <span style="color: #F92672;">self</span>.mean_level(<span style="color: #F92672;">self</span>.mean_exp_level)
        <span style="color: #F92672;">self</span>.mean_level(<span style="color: #F92672;">self</span>.mean_age_level)
        <span style="color: #F92672;">self</span>.dissimilarity_index()

        <span style="color: #75715E;">## </span><span style="color: #75715E;">Moving changed values to Audit trail</span>
        <span style="color: #F92672;">self</span>.audit_trail(<span style="color: #AE81FF;">False</span>)
</pre>
</div>


<p>
Before adding a method to the indicators class, we advise to test
it in a different file without modifying the main code in
<code>rmindicators.py</code>. Let's start with an example on how to do
this, and by the end of this subsection, we will give you a template to use for all other example. First, in a new script, import the <code>rmquestionnaire</code>
library. This can be achieved with the following code:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #F92672;">import</span> sys, os

os.chdir(path_to_main_RMS_folder) <span style="color: #75715E;"># </span><span style="color: #75715E;">modify here.</span>
sys.path.append(<span style="color: #E6DB74;">'Libraries'</span>)

<span style="color: #F92672;">from</span> rmquestionnaire <span style="color: #F92672;">import</span> *
</pre>
</div>

<p>
by modifying the <code>path_to_main_RMS_folder</code> to your path to the main
folder where <code>RMS</code> is installed, for example <code>/Desktop/RMS</code> if it
is installed on your desktop. Second, create a test class that
inherits all the methods in the <code>indicators</code> class, you can do this
using the following code.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #F92672;">class</span> <span style="color: #66D9EF;">tests_indicators</span>(indicators):
</pre>
</div>

<p>
Finally, use the SQL methods of class <code>indicators</code> to write to
SQL. This could be done by <code>write_indic_sql</code>, which writes a
dictionary of indicator values to SQL. The key of the dictionary is
the indicator name, and the value of the dictionary is the
indicators values. The following is a complete template that you
can use by modifying the path to the main RMS directory and the
indicator and function names.
</p>

<div class="org-src-container">

<pre class="src src-python"> <span style="color: #F92672;">import</span> sys, os
 os.chdir(path_to_main_RMS_folder)  <span style="color: #75715E;"># </span><span style="color: #75715E;">Path to main directory</span>
 sys.path.append(<span style="color: #E6DB74;">'Libraries'</span>)
 <span style="color: #F92672;">from</span> rmquestionnaire <span style="color: #F92672;">import</span> *

<span style="color: #F92672;">class</span> <span style="color: #66D9EF;">tests_indicators</span>(indicators):
     <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">function_indicator_name</span>(<span style="color: #F92672;">self</span>):
         <span style="color: #75715E;"># </span><span style="color: #75715E;">The following is a dictionary used for inserting the value in the database</span>
         <span style="color: #FD971F;">ind_dict</span>={}
         <span style="color: #FD971F;">indicator_name</span>=<span style="color: #E6DB74;">"MyIndicator"</span>
         <span style="color: #75715E;">### </span><span style="color: #75715E;">Start of indicator calculation method</span>

         <span style="color: #FD971F;">indicator_values</span>= = ....... <span style="color: #75715E;"># </span><span style="color: #75715E;">attach indicator values to this variable</span>
         <span style="color: #75715E;">### </span><span style="color: #75715E;">End of indicator calculation method</span>

         <span style="color: #75715E;"># </span><span style="color: #75715E;">We prepare a dictionary for the function write_indic_sql</span>
         <span style="color: #FD971F;">ind_dict</span>[indicator_name]=indicator_values
         <span style="color: #F92672;">self</span>.write_indic_sql(ind_dict)
</pre>
</div>


<p>
At this point we are ready to program the new indicator method. 
</p>

<p>
Let us say that we want to compute the proportion of teachers in
public schools in ISCED1 that have one or two years of
experience. Let us call this indicator "PT.1.Pu.Exp1t2". This would
correspond to dividing "T.1.Pu.Exp1t2" by "T.1.Pu". The method
<code>column_operation</code> is very handy in this case. Many current
indicators rely on this function, therefore it deserves a
discussion by itself.
</p>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> Column operation</h3>
<div class="outline-text-3" id="text-3-3">
<p>
The function <code>column operation</code> applies a function to two columns
in any of the tables of the RM questionnaire. Since all columns
are indexed by an alphanumeric code (AC), it is sufficient to pass
the ACs themselves and <code>column_operation</code> will extract all the
region and national figures of these two ACs and preform an
operation on each of the adjacent cells of these columns.
</p>

<p>
The <code>column_operation</code> has three arguments, the first two
arguments have the form <code>[AC,year]</code>, where AC is an alphanumeric
code and year is either 0 or -1. 0 stands for the value of the
current year and -1 for the previous year. We only pass 0 or -1
rather than the complete year as 2014 or 2015, because by
initiating the indicator class, you need to pass to it the country
name and year, thus it already knows this information. The third
argument is a function of the following <code>sum</code>, <code>prod</code>, <code>div</code> and
<code>neg</code> that compute the sum, multiplication, division and negation
according to a specific set of rules that we call <i>algebras</i>. All
these functions are seen in the first part of
<code>Libraries/rmindicators.py</code> and are not the default Python
operations. It is also possible to only pass the first
argument. In this case the values that correspond to the
AC and year are returned.
</p>

<p>
To use any of the four mathematical operations, each takes two
arguments of the form <code>[fig, symbol]</code> (it can be a list or a
tupple). <code>symbol</code> has to be one of the following: 'a', 'm', 'n',
'x' or 'value' depending if the data is not applicable, missing,
null, a reference or a number respectively. <code>fig</code> is the value to
which the operation is going to be applied. The functions return a
pair <code>[value, symbol]</code> as well, where value is the result of the function
applied to the values received and symbol is the magnitude of this
value. 
</p>

<p>
The objective of the algebra is to decide whether the
operation should be performed or the data is irregular. For
example, when you attempt to sum two columns say, <code>E.1.Pu</code> and
<code>E.1.Pr</code>, say that for one of the regions <code>E.1.Pu=10</code> while
<code>E.1.Pr</code> is missing, what should be the value of the sum? We
answer this question by constructing a table as shown below, where
the upper left corner is the name of the operation, and each cell,
excluding the row and column headers, corresponds to the resulting
magnitude value when preforming the operation. For example, since
<code>E.1.Pu=10</code> and say it doesn't include any other category, then
its magnitude is <code>value</code>, while <code>E.1.Pr</code> has a magnitude of <code>m</code>
for missing. Thus, the sum of <code>[10, 'value']</code> and <code>['', 'm']</code> would
return <code>['', 'm']</code> as a null <code>fig</code> and a missing magnitude
<code>symbol</code>, based on the table below. The cell that corresponds to <code>value</code>
and <code>m</code> is <code>m</code>.
</p>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Sum</th>
<th scope="col" class="left">a</th>
<th scope="col" class="left">m</th>
<th scope="col" class="left">n</th>
<th scope="col" class="left">x</th>
<th scope="col" class="left">value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left"><b>a</b></td>
<td class="left">a</td>
<td class="left">a</td>
<td class="left">a</td>
<td class="left">a</td>
<td class="left">a</td>
</tr>

<tr>
<td class="left"><b>m</b></td>
<td class="left">a</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">m</td>
</tr>

<tr>
<td class="left"><b>n</b></td>
<td class="left">a</td>
<td class="left">m</td>
<td class="left">n</td>
<td class="left">m</td>
<td class="left">value</td>
</tr>

<tr>
<td class="left"><b>x</b></td>
<td class="left">a</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">m</td>
</tr>

<tr>
<td class="left"><b>value</b></td>
<td class="left">a</td>
<td class="left">m</td>
<td class="left">value</td>
<td class="left">m</td>
<td class="left">value</td>
</tr>
</tbody>
</table>

<p>
In Python this looks like:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #F92672;">sum</span>([10, <span style="color: #E6DB74;">'value], ['', '</span>m<span style="color: #E6DB74;">']) = ['', '</span>m<span style="color: #E6DB74;">']</span>
</pre>
</div>


<p>
While if <code>E.1.Pr=5</code> then the cell that corresponds to <code>(value, value)</code> is also <code>value</code>, in this case the sum operation is performed. 
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #F92672;">sum</span>([10, <span style="color: #E6DB74;">'value], [5, '</span>value<span style="color: #E6DB74;">']) = [15, '</span>value<span style="color: #E6DB74;">']</span>
</pre>
</div>

<p>
You can view and change these algebra rules in the following files:
</p>
<ul class="org-ul">
<li><code>RMS/Libraries/algebra-sum.csv</code> for the sum algebra as in the table above.
</li>
<li><code>RMS/Libraries/algebra-prod.sv</code> for the product algebra.
</li>
<li><code>RMS/Libraries/algebra-div.csv</code> for the division algebra.
</li>
</ul>
<p>
The negation algebra is the same as the sum algebra. 
</p>

<p>
By default the RMS software is delivered with those sets of algebras, in addition to the sum algebra above.  
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Div</th>
<th scope="col" class="left">a</th>
<th scope="col" class="left">m</th>
<th scope="col" class="left">n</th>
<th scope="col" class="left">x</th>
<th scope="col" class="left">value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left"><b>a</b></td>
<td class="left">a</td>
<td class="left">a</td>
<td class="left">a</td>
<td class="left">a</td>
<td class="left">a</td>
</tr>

<tr>
<td class="left"><b>m</b></td>
<td class="left">a</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">m</td>
</tr>

<tr>
<td class="left"><b>n</b></td>
<td class="left">a</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">n</td>
</tr>

<tr>
<td class="left"><b>x</b></td>
<td class="left">a</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">m</td>
</tr>

<tr>
<td class="left"><b>value</b></td>
<td class="left">a</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">value</td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Prod</th>
<th scope="col" class="left">a</th>
<th scope="col" class="left">m</th>
<th scope="col" class="left">n</th>
<th scope="col" class="left">x</th>
<th scope="col" class="left">value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left"><b>a</b></td>
<td class="left">a</td>
<td class="left">a</td>
<td class="left">a</td>
<td class="left">a</td>
<td class="left">a</td>
</tr>

<tr>
<td class="left"><b>m</b></td>
<td class="left">a</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">m</td>
</tr>

<tr>
<td class="left"><b>n</b></td>
<td class="left">a</td>
<td class="left">m</td>
<td class="left">n</td>
<td class="left">n</td>
<td class="left">n</td>
</tr>

<tr>
<td class="left"><b>x</b></td>
<td class="left">a</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">m</td>
<td class="left">m</td>
</tr>

<tr>
<td class="left"><b>value</b></td>
<td class="left">a</td>
<td class="left">m</td>
<td class="left">n</td>
<td class="left">m</td>
<td class="left">value</td>
</tr>
</tbody>
</table>

<div class="important">
<p>
The algebra files are read every time the <code>RM_GUI</code> is initiated, thus,
if the user doesn't agree with the result of the algebra you can
change it directly in the file. <b>Be careful</b> as the software might
behave inappropriately if the algebra is set wrong. For example, when
summing a numeric value with a non-numeric one.
</p>

</div>

<p>
Now to sum any two ACs, or columns, of the RM questionnaire, one can use the <code>column_operation</code> function directly as 
</p>

<div class="org-src-container">

<pre class="src src-python">column_operation([<span style="color: #E6DB74;">'E.1.Pr'</span>, 0], [<span style="color: #E6DB74;">'E.1.Pu'</span>, 0], <span style="color: #F92672;">sum</span>)
</pre>
</div>
<p>
This would return the sum of the each of the two adjacent cells of the columns, that is region by region. 
</p>
</div>
</div>

<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4"><span class="section-number-3">3.4</span> Example</h3>
<div class="outline-text-3" id="text-3-4">
<p>
To get back to our example, we wanted to compute the proportion of
teachers in public schools in ISCED1 that have one or two years of
experience. Let us call this indicator "PT.1.Pu.Exp1t2". This would
correspond to dividing "T.1.Pu.Exp1t2" by "T.1.Pu". To do so, we
use the <code>column_operation</code> and the <code>div</code> auxiliary method, with the template provided in the end of <a href="#sec-3-2">3.2</a> section.
</p>

<p>
We define the function name as <code>proportion_public_teachers_1t2exp_isced1(self)</code>, and the code looks like:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #F92672;">class</span> <span style="color: #66D9EF;">tests_indicators</span>(indicators):
    <span style="color: #F92672;">def</span> <span style="color: #A6E22E;">proportion_public_teachers_1t2exp_isced1</span>(<span style="color: #F92672;">self</span>):
        <span style="color: #75715E;"># </span><span style="color: #75715E;">The following is a dictionary used for inserting the value in the database</span>
        <span style="color: #FD971F;">ind_dict</span>={}
        <span style="color: #FD971F;">indicator_name</span>=<span style="color: #E6DB74;">"PT.1.Pu.Exp1t2"</span>
        <span style="color: #FD971F;">indicator_values</span>=<span style="color: #F92672;">self</span>.column_operation([<span style="color: #E6DB74;">"T.1.Pu.Exp1t2"</span>,0],[<span style="color: #E6DB74;">"T.1.Pu"</span>,0],div)
        <span style="color: #75715E;"># </span><span style="color: #75715E;">We prepare a dictionary for the function write_indic_sql</span>
        <span style="color: #FD971F;">ind_dict</span>[indicator_name]=indicator_values
        <span style="color: #F92672;">self</span>.write_indic_sql(ind_dict)
</pre>
</div>


<p>
We can test the new indicator with the following code
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #FD971F;">test_object</span>=tests_indicators(path_to_database,year,country_name,<span style="color: #E6DB74;">'test_user'</span>)
test_object.proportion_public_teachers_1t2exp_isced1()
</pre>
</div>

<p>
where <code>path_to_database</code> is a string with the full path to the
database file, <code>year</code> the data year, i.e 2014, for which the
indicator is being computed and <code>country_name</code> is the country name
of interest. 
</p>

<p>
In order for this to work, a questionnaire for the
corresponding country and year should have been already inserted in
the database. After running the command above, it is possible to
check the computed indicator directly in the database. To do this,
open the database with sqlite and run the following command:
</p>

<div class="org-src-container">

<pre class="src src-sqlite"><span style="color: #F92672;">SELECT</span> IND_ID ,ADM_CODE, FIG <span style="color: #F92672;">FROM</span>  EDU_INDICATOR_EST <span style="color: #F92672;">AS</span> A 
<span style="color: #F92672;">JOIN</span> COUNTRY <span style="color: #F92672;">AS</span> B <span style="color: #F92672;">ON</span> A.CO_CODE = B.CO_CODE 
<span style="color: #F92672;">WHERE</span> B.CO_LONG_NAME= country_name ;
</pre>
</div>

<p>
Notice that <code>country_name</code> above has to be changed for the actual
name of the country you are using for the test. 
</p>

<p>
Let us say that now you feel confident with your indicator function
and that you want it to be included in the indicators computed by
the GUI. What you need to do is to copy your method that computes
the indicator into the indicators class in the
<code>/RMS/Libraries/rmindicators.py</code> file. After doing this you need to
add a call to this method in the <code>compute_all_indicators</code>.
</p>

<p>
In our example, we copy the following code from the <code>tests_indicators</code> class above:
</p>


<div class="org-src-container">

<pre class="src src-python"><span style="color: #F92672;">def</span> <span style="color: #A6E22E;">proportion_public_teachers_1t2exp_isced1</span>(<span style="color: #F92672;">self</span>):
          <span style="color: #75715E;"># </span><span style="color: #75715E;">The following is a dictionary used for inserting the value in the database</span>
          <span style="color: #FD971F;">ind_dict</span>={}
          <span style="color: #FD971F;">indicator_name</span>=<span style="color: #E6DB74;">"PT.1.Pu.Exp1t2"</span>
          <span style="color: #FD971F;">indicator_values</span>=<span style="color: #F92672;">self</span>.column_operation([<span style="color: #E6DB74;">"T.1.Pu.Exp1t2"</span>,0],[<span style="color: #E6DB74;">"T.1.Pu"</span>,0],div)
          <span style="color: #75715E;"># </span><span style="color: #75715E;">We prepare a dictionary for the function write_indic_sql</span>
          <span style="color: #FD971F;">ind_dict</span>[indicator_name]=indicator_values
          <span style="color: #F92672;">self</span>.write_indic_sql(ind_dict)
</pre>
</div>

<p>
and paste it after the line 
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #F92672;">class</span> <span style="color: #66D9EF;">indicators</span>():
</pre>
</div>
<p>
in the file <code>RMS/Libraries/rmindicators.py</code>. Finally add the line
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #F92672;">self</span>.proportion_public_teachers_1t2exp_isced1()
</pre>
</div>

<p>
to the body of the method <code>compute_all_indicators</code> between the <code>self.audit_trail</code> methods. 
</p>

<p>
Now if you use the GUI to calculate indicators, your new indicator should appear in the drop-down list of indicators.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Code Documentation</h2>
<div class="outline-text-2" id="text-4">
<p>
This section explains how to process questionnaire data of the Regional Module Questionnaire using Python code of RMS directly, instead of the Graphical
User Interface (GUI). The first step is to import the library
<code>rmquestionnaire</code> in <code>RMS\Libraries</code>, you can use the following code
example.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #F92672;">import</span> sys,os
os.chdir(path_to_main_RMS_folder)    <span style="color: #75715E;"># </span><span style="color: #75715E;">replace path_to_main_RMS_folder</span>
sys.path.append(<span style="color: #E6DB74;">'Libraries'</span>)
<span style="color: #F92672;">from</span> rmquestionnaire <span style="color: #F92672;">import</span> *
</pre>
</div>

<p>
Replace <code>path_to_main_RMS_folder</code> for a string  with the full path to
your main RMS folder.
</p>
</div>

<div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> Processing a questionnaire</h3>
<div class="outline-text-3" id="text-4-1">
<p>
In order to import data from a questionnaire the <code>questionnaire</code> class
should be used. Four arguments are needed when an object from this
class is initiated: the Excel file name, the database file path, the
log folder path and a user name. The following is an example.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #FD971F;">Excel_file</span>=<span style="color: #E6DB74;">"Regional_Survey_2015.xlsx"</span>
<span style="color: #FD971F;">database_file</span>= <span style="color: #E6DB74;">"Database/Prod.db"</span>
<span style="color: #FD971F;">log_folder</span>=<span style="color: #E6DB74;">"/tmp/log/"</span>
<span style="color: #FD971F;">username</span>=<span style="color: #E6DB74;">"user"</span>
<span style="color: #FD971F;">qobject</span>=questionnaire(Excel_file,database_file,log_folder,username)
</pre>
</div>
<p>
By initiating the <code>qobject</code> as shown above, the class reads the file
to know if the questionnaire is being imported for the first time or
if it is an <code>Edit</code> mode questionnaire and what database series to use,
i.e. OBS, REP or EST. Also, <code>questionnaire</code> checks that the country
name used in the file exists in the database, otherwise, an error is
raised.
</p>
</div>

<div id="outline-container-sec-4-1-1" class="outline-4">
<h4 id="sec-4-1-1"><span class="section-number-4">4.1.1</span> Preprocessing</h4>
<div class="outline-text-4" id="text-4-1-1">
</div><ol class="org-ol"><li><a id="sec-4-1-1-1" name="sec-4-1-1-1"></a>Validation<br  /><div class="outline-text-5" id="text-4-1-1-1">
<p>
Before extracting the data there is a validation step that takes
place, similar to when using the GUI. This is done by the method called <b>validation</b> in the
<code>questionnaire</code> class. It works by calling in order the following
methods from the class.
</p>

<dl class="org-dl">
<dt> check_nadm1 </dt><dd>Returns <code>True</code> if the number of administrative
divisions is filled and <code>False</code> otherwise.
</dd>
<dt> check_adm1_label </dt><dd>Returns <code>True</code> if the label of administrative
divisions is filled (e.g. state, province, etc. ) and <code>False</code>
otherwise.
</dd>
<dt> check_adm1_names </dt><dd>Returns <code>True</code> if the name of each
administrative division is filled and <code>False</code> otherwise.
</dd>
<dt> check_reference_year </dt><dd>Returns <code>True</code> if the reference year (Cell
<code>M14</code> in the Policy Information sheet) is filled in the
questionnaire and a positive integer.
</dd>
<dt> check_country_name </dt><dd>Returns <code>True</code> if the country name is filled
and <code>False</code> otherwise.
</dd>
<dt> check_number_of_sheets </dt><dd>Returns <code>False</code> for an original
questionnaire where the number of sheets does not coincide with
the number of sheets originally provided in the questionnaire. In
any other case it returns <code>True</code>.
</dd>
<dt> check_edited_configuration_part </dt><dd>Returns <code>False</code> for an edited
questionnaire without the configuration panel in the top left
corner. In any other case it returns <code>True</code>.
</dd>
<dt> check_values </dt><dd>Checks that all the values reported in the
questionnaire are a positive integers, inclusions or
A,a,N,n,Z,z,M,m. If this is the case it returns <code>True</code>, otherwise it
returns <code>False</code>.
</dd>
</dl>

<p>
<b>validation</b> returns <code>True</code> when all of these checks return <code>True</code>. If
at least one of them returns <code>False</code>, <b>validation</b> returns <code>False</code> and
in this case the questionnaire should not be processed. A validation report with
some information of the questionnaire and the results of the checks is
written in a file with name syntax <code>countryname_datetime_validation.txt</code> in
the <code>Log</code> folder.
</p>

<p>
Using the previous code box, you can run this as, 
</p>

<div class="org-src-container">

<pre class="src src-python">qobject.validation()
</pre>
</div>
<p>
and the return value is <code>True</code> or <code>False</code>.
</p>
</div>
</li>

<li><a id="sec-4-1-1-2" name="sec-4-1-1-2"></a>Data Report<br  /><div class="outline-text-5" id="text-4-1-1-2">
<p>
After a successful validation step, there might be missing data or inconsistencies in the questionnaire. These are not considered
an impediment for processing the questionnaire. They are reported in the data report; a
file with name syntax <code>countryname_datetime_data_report.csv</code> saved to the 
<code>Log</code> folder.
</p>

<p>
The data report is generated by the method <b>write_data_report</b> in the
<code>questionnaire</code> class. It is a csv file divided in three parts.
</p>

<p>
The first part is called "Missing data". It lists the sheet name, table
name and columns that contain missing data in the questionnaire.
</p>

<p>
The second part is called "Data Issues". The following four types of
inconsistencies are reported in this section.
</p>

<dl class="org-dl">
<dt> Undefined references </dt><dd>     This is a cell with the value X with no column number.
</dd>
<dt> Improper inequalities </dt><dd>    In the cases where some columns should have values smaller
than others in different columns,the method <b>check_less</b> validates these cases. In this method there is a dictionary called <code>check_less_dictionary</code> whose
keys are table names and the values are a list of pairs with column
numbers. For each pair in the list the first column should have
smaller values than the second one, region by region. Extra checks of this type can
be easily added by just adding the desired columns to this dictionary.
</dd>
<dt> Improper column sums </dt><dd>    There are some groups of columns when added should give other
columns (for example private and public should give the
total). When this does not happen this is written in the data
report. The check is done with the method <b>check_column_sums</b>. In
this method the local dictionary variable
<code>check_columns_sums_dictionary</code> has keys with table names and the
values are lists of pairs. The first element of each pair is a
list of column numbers whose values should add to the column number
given in the second element of the pair. It is possible to easily add
more checks of this type by just editing this dictionary.
</dd>
<dt> Incorrect region totals </dt><dd>    The values of all the regions should add to the country total. The
cases where this does not happen are reported. This is done with
the help of the method <b>check_region_totals</b>.
</dd>
</dl>

<p>
The third and last part of the data report consists of a list of all
the items in the <code>Checking sheet</code> of the questionnaire that have the
value <code>No</code>, this only applies to imports in original questionnaire format where <code>Checking sheet</code> exist.
</p>

<p>
Before calling the <b>write_data_report</b> method it is necessary to call
the following three methods: <b>check_region_totals</b>,
<b>check_less</b>, <b>check_column_sums</b>. These methods populate the
attribute <code>data_issues_dictionary</code> that is used by
<b>write_data_report</b>.
</p>

<p>
The following code performs the validation step and data report for
the example we have been developing.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #F92672;">if</span> qobject.validation():
    qobject.check_region_totals()
    qobject.check_less()
    qobject.check_column_sums()
    qobject.write_data_report()
</pre>
</div>
</div>
</li></ol>
</div>

<div id="outline-container-sec-4-1-2" class="outline-4">
<h4 id="sec-4-1-2"><span class="section-number-4">4.1.2</span> Data and comments extraction</h4>
<div class="outline-text-4" id="text-4-1-2">
<p>
The <code>extract_data</code> method reads the values and enters them in the
database. It also writes the region names to the regions database if
an original questionnaire is being inserted the first time. The values are also
inserted in the audit trail table  with the current timestamp, if there is a change from the previously inserted version. For more details about audit trail functionality read 
<a href="#sec-1-6">Audit trail</a> section.
</p>

<p>
There are two different types of comments, cell comments and table
comments. The cell comments are part of Excel functionality, while
table comments are on the top of each table in the questionnaire. Cell
comments can be imported to the database with the <code>extract_comments</code>
method and table comments with the <code>extract_table_comments</code> method.
</p>

<p>
The following lines of code extract the data, cell comments and table
comments and add them to the database.
</p>


<div class="org-src-container">

<pre class="src src-python">qobject.extract_data()
qobject.extract_comments()
qobject.extract_table_comments()
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> Computing indicators</h3>
<div class="outline-text-3" id="text-4-2">
<p>
After extracting the data and putting it in the database it is
possible to compute indicators. The indicators are only computed form
the 'EST' series. At this point we have imported the data to the
reported series ('REP'). We need to copy the data to the estimated
series ('EST') in order to compute the indicators. This can be
achieved using the <b>moveSerie</b> function. Before using this function it
is necessary to tell the program what database file is being
used. This is done with the function <b>set_database_file</b> which
receives as the only argument the full path to the database file. It was
done this way since one might want to interact with the database
without importing a questionnaire. The following code moves the data and comments from 'REP' to 'EST' series.
</p>

<div class="org-src-container">

<pre class="src src-python">set_database_file(<span style="color: #E6DB74;">'Database/Prod.db'</span>)
<span style="color: #FD971F;">co_code</span> = qobject.country_code
<span style="color: #FD971F;">year</span> = qobject.emco_year
<span style="color: #FD971F;">from_serie</span>=<span style="color: #E6DB74;">'REP'</span>
<span style="color: #FD971F;">to_serie</span>=<span style="color: #E6DB74;">'EST'</span>
moveSerie(co_code, year, from_serie, to_serie)
</pre>
</div>
<p>
After the EST series have been populated, we can compute the
indicators. This is done with the <b>rmindicators</b> class. After having
instantiated an object of this class for the desired country and year,
the method <b>compute_all_indicators</b> will compute and fill the
indicators table. Here is an example code which instantiates this class
for the data used in the example script being developed along this
section.
</p>


<div class="org-src-container">

<pre class="src src-python"><span style="color: #FD971F;">database</span>=<span style="color: #E6DB74;">"Database/Prod.db"</span>
<span style="color: #FD971F;">emco_year</span>=2015
<span style="color: #FD971F;">country_name</span>=<span style="color: #E6DB74;">"Lao People's Democratic Republic"</span>
<span style="color: #FD971F;">ind_object</span>=indicators(<span style="color: #E6DB74;">"Database/Prod.db"</span>,2015,<span style="color: #E6DB74;">"Lao People's Democratic Republic"</span>,username)
ind_object.compute_all_indicators()
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3"><span class="section-number-3">4.3</span> Exporting data</h3>
<div class="outline-text-3" id="text-4-3">
</div><div id="outline-container-sec-4-3-1" class="outline-4">
<h4 id="sec-4-3-1"><span class="section-number-4">4.3.1</span> Exporting questionnaire data</h4>
<div class="outline-text-4" id="text-4-3-1">
<p>
In order to export the questionnaire data from the database to an
Excel file, the <code>xlsxwriter</code> modules needs to be used in combination
with the function <code>export_var</code>. As shown in the following example,
first the Excel workbook needs to be created and then <code>export_var</code>
needs to be called for each desired sheet.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #F92672;">import</span> xlsxwriter

<span style="color: #FD971F;">co_name</span> = qobject.country_name    
<span style="color: #FD971F;">filename</span> = <span style="color: #E6DB74;">"{0}_{1}.xlsx"</span>.<span style="color: #F92672;">format</span>(co_name, 2015)

<span style="color: #FD971F;">wb</span> = xlsxwriter.Workbook(filename)

export_var(<span style="color: #E6DB74;">'Administrative divisions'</span>, wb, co_code, year, var_type = <span style="color: #E6DB74;">"sheet"</span>)
export_var(<span style="color: #E6DB74;">'Pupils'</span>, wb, co_code, year, var_type = <span style="color: #E6DB74;">"sheet"</span>)
export_var(<span style="color: #E6DB74;">'Teachers ISCED 1'</span>, wb, co_code, year, var_type = <span style="color: #E6DB74;">"sheet"</span>,serie= <span style="color: #E6DB74;">'REP'</span>)
export_var(<span style="color: #E6DB74;">'Teachers ISCED 2'</span>, wb, co_code, year, var_type = <span style="color: #E6DB74;">"sheet"</span>,serie= <span style="color: #E6DB74;">'REP'</span>)
export_var(<span style="color: #E6DB74;">'Teachers ISCED 3'</span>, wb, co_code, year, var_type = <span style="color: #E6DB74;">"sheet"</span>,serie= <span style="color: #E6DB74;">'REP'</span>)
export_var(<span style="color: #E6DB74;">'Teachers ISCED 2t3'</span>, wb, co_code, year, var_type = <span style="color: #E6DB74;">"sheet"</span>,serie= <span style="color: #E6DB74;">'REP'</span>)
wb.close()
</pre>
</div>
<p>
After running this code an Excel file with name syntax
<code>countryname_2015.xlsx</code> is created containing the data of all the
sheets that were passed to <b>export_var</b> before <code>wb.close()</code>. Notice
that <code>serie</code> can take one of the values 'REP', 'OBS' or 'EST' which
correspond to reported, observed and estimated database respectively.
</p>
</div>
</div>

<div id="outline-container-sec-4-3-2" class="outline-4">
<h4 id="sec-4-3-2"><span class="section-number-4">4.3.2</span> Exporting indicators</h4>
<div class="outline-text-4" id="text-4-3-2">
<p>
It is also possible to export an Excel file with the values of all the
indicators or for one of them. This can be achieved with the function
<b>export_indc</b>. In order for this function to work it is also necessary
to first call the function <code>set_database_file</code>.
</p>

<p>
One can export one indicator or all of them to an Excel
file. If <code>All</code> is passed as an argument to <b>export_indc</b> then all the
indicators are exported. The other option is to pass the
indicator ID of the desired indicator (e.g. 'NTP.1'), or a wildcard of an ID, as '%T.1%' for all indicators with the 'T.1' pattern in their name.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #FD971F;">indicators_filename</span>=<span style="color: #E6DB74;">"{0}_{1}_indicators.xlsx"</span>.<span style="color: #F92672;">format</span>(co_name, 2015)
<span style="color: #FD971F;">indicators_wb</span> = xlsxwriter.Workbook(indicators_filename)
export_indc(<span style="color: #E6DB74;">"All"</span>, indicators_wb, co_code, year)
indicators_wb.close()
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4"><span class="section-number-3">4.4</span> Software folder tree</h3>
<div class="outline-text-3" id="text-4-4">
<p>
The following is the RMS software directory only tree, where all directory
levels are printed, following that the complete tree including all
individual files.
</p>

<div class="org-src-container">

<pre class="src src-sh">RMS/
|-- Database
|   <span style="color: #AE81FF; font-weight: bold;">`-- Inserted data</span>
<span style="color: #AE81FF; font-weight: bold;">|-- Documentation</span>
<span style="color: #AE81FF; font-weight: bold;">|   |-- css</span>
<span style="color: #AE81FF; font-weight: bold;">|   |-- img</span>
<span style="color: #AE81FF; font-weight: bold;">|   `</span>-- Python help
|-- Export
|-- Import
|-- Libraries
<span style="color: #AE81FF; font-weight: bold;">`-- Log</span>

<span style="color: #AE81FF; font-weight: bold;">10 directories</span>
</pre>
</div>

<div class="org-src-container">

<pre class="src src-sh">RMS/
|-- Database
|   |-- Inserted data
|   |   |-- ADM_table.csv
|   |   |-- All AC CODES.csv
|   |   |-- Country.csv
|   |   |-- EDU_INDICATOR_AID.csv
|   |   |-- EDU_INDICATOR_AID_full.xlsx
|   |   |-- EDU_METER_AID(data).csv
|   |   |-- Magnitude(data).csv
|   |   |-- NEW AC CODES inserted<span style="color: #F92672;"> in</span> EDU_METER_AID.csv
|   |   |-- Qualifier.csv
|   |   |-- RM_Mapping.csv
|   |   <span style="color: #AE81FF; font-weight: bold;">`-- RM_Mapping_NonNumeric.csv</span>
<span style="color: #AE81FF; font-weight: bold;">|   |-- create_database.bat</span>
<span style="color: #AE81FF; font-weight: bold;">|   |-- create_tables.sql</span>
<span style="color: #AE81FF; font-weight: bold;">|   |-- insert_data.sql</span>
<span style="color: #AE81FF; font-weight: bold;">|   |-- insert_indic_labels.sql</span>
<span style="color: #AE81FF; font-weight: bold;">|   |-- library.sql</span>
<span style="color: #AE81FF; font-weight: bold;">|   |-- main.sql</span>
<span style="color: #AE81FF; font-weight: bold;">|   |-- migration_to_DB_with_indic.sql</span>
<span style="color: #AE81FF; font-weight: bold;">|   |-- Prod.db</span>
<span style="color: #AE81FF; font-weight: bold;">|   `</span>-- README.md
|-- Documentation
|   |-- css
|   |-- img
|   |-- Python help
|   |   |-- rmExcelWriter.html
|   |   |-- rmfunctions.html
|   |   |-- RM_GUI.html
|   |   |-- rmindicators.html
|   |   <span style="color: #AE81FF; font-weight: bold;">`-- rmsqlfunctions.html</span>
<span style="color: #AE81FF; font-weight: bold;">|   |-- README.md</span>
<span style="color: #AE81FF; font-weight: bold;">|   |-- user-manual.html</span>
<span style="color: #AE81FF; font-weight: bold;">|   |-- user-manual.org</span>
<span style="color: #AE81FF; font-weight: bold;">|   |-- user-manual.pdf</span>
<span style="color: #AE81FF; font-weight: bold;">|   `</span>-- user-manual.tex
|-- Export
|   <span style="color: #AE81FF; font-weight: bold;">`-- README.md</span>
<span style="color: #AE81FF; font-weight: bold;">|-- Import</span>
<span style="color: #AE81FF; font-weight: bold;">|   `</span>-- README.md
|-- Libraries
|   |-- algebra-div.csv
|   |-- algebra-prod.csv
|   |-- algebra-sum.csv
|   |-- Pip install.md
|   |-- README.md
|   |-- rmExcelWriter.py
|   |-- rmfunctions.py
|   |-- rmindicators.py
|   |-- rmquestionnaire.py
|   |-- rmsqlfunctions.py
|   <span style="color: #AE81FF; font-weight: bold;">`-- variables_for_preprocessing.json</span>
<span style="color: #AE81FF; font-weight: bold;">|-- Log</span>
<span style="color: #AE81FF; font-weight: bold;">|   `</span>-- README.md
|-- README.md
<span style="color: #AE81FF; font-weight: bold;">`-- RM_GUI.py</span>

<span style="color: #AE81FF; font-weight: bold;">10 directories, 46 files</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-5" class="outline-3">
<h3 id="sec-4-5"><span class="section-number-3">4.5</span> Python help files</h3>
<div class="outline-text-3" id="text-4-5">
<p>
Python has its own help documentation that could be created using
<code>pydoc3</code> for any script. In the <a href="#sec-4-4">Software folder tree</a> section, the
tree lists 6 <code>.py</code> files, 5 in folder <code>/Libraries</code> and the
<code>RM_GUI.py</code> in the main directory. The following are the links to
the Python help files of each.
</p>
<ul class="org-ul">
<li><a href="Python help/rmExcelWriter.html">Libraries/rmExcelWriter.py</a>
</li>
<li><a href="Python help/rmfunctions.html">Libraries/rmfunctions.py</a>
</li>
<li><a href="Python help/rmindicators.html">Libraries/rmindicators.py</a>
</li>
<li><a href="Python help/rmsqlfunctions.html">Libraries/rmsqlfunctions.py</a>
</li>
<li><code>Libraries/rmquestionnaire.py</code> does not have a help file since it only loads all the other scripts. 
</li>
<li><a href="Python help/RM_GUI.html">RM_GUI.py</a>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: February 2016</p>
<p class="author">Author: Mohamad Elmasri and Oscar Quijano</p>
<p class="date">Created: 2016-03-08 Tue 08:52</p>
<p class="creator">Emacs 24.4.1 (Org mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
